<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CADET.LV InteraktÄ«vais kompass Â©JÄnis Eglis</title>
	
    <style>
		#openInteractivebuttoncase{
			display: inline-flex;
			justify-content: center;
            align-items: center;
			width:100%;
			height:90%
		}
	
        #openInteractive {
		    display: flex;
            padding: 10px 20px;
            background-color: #783200;
            color: white;
            border: none;
            border-radius: 3px;
            font-size: 16px;
            cursor: pointer;
			font-size: 16px;
			width:80%;
			justify-content: center;
            align-items: center;
			
        }
        #openInteractive:hover {
            background-color: #bf5509;
			
        }
    </style>


<p id="openInteractivebuttoncase">
    <button id="openInteractive">AtvÄ“rt InteraktÄ«vo kompasu</button>
</p>


    <script>
        document.getElementById('openInteractive').addEventListener('click', () => {
            const interactiveWindow = window.open('', '_blank', 'width=800,height=600');

            if (interactiveWindow) {
                // HTML saturs jaunajÄ logÄ
                interactiveWindow.document.write(`
                    <!DOCTYPE html>
                    <html lang="lv">
                    <head>
                        <meta charset="UTF-8">
						<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
                        <link rel="icon" type="image/png" href="https://site-710050.mozfiles.com/files/710050/CADET_ICON.PNG">

                        <title>CADET.LV InteraktÄ«vais kompass Â©JÄnis Eglis</title>
                        
                        <style>
						
							:root {
							  --vh: 1vh; 
							}
						
							body, html {
                              height: 100%; 
                              margin: 0; 
                              padding: 0; 
                            }
						
							body {
								height: calc(var(--vh) * 100); /* ReÄlais viewport augstums */
							}
						
                            body {
                                margin: 0;
                                padding: 0;
                                background-color: #f0f0f0;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                height: calc(var(--vh, 1vh) * 100);
                                overflow: hidden;
                                position: relative;
                            }
                            canvas {
                                background-color: #181818;
                                background-image: url('https://site-710050.mozfiles.com/files/710050/medium/CADET_TRANSP_.png?1542126381');
                                background-repeat: no-repeat;
                                background-attachment: fixed;
                                background-size: 70% 30%;
                                background-position: center;
                                z-index: 1;
								height: 100%; /* nodroÅ¡ina, ka canvas izmanto vecÄku konteineru */
                                width: 100%; /* pielÄgojas loga platumam */
                            }
                            #fullscreenMessage {
                                position: fixed;
                                z-index: 15;
                                color: white;
                                background-color: rgba(0, 0, 0, 0.4);
                                width: 100%;
                                height: 100vh;
                                justify-content: center; /* HorizontÄlais centrÄ“jums */
    							align-items: center; /* VertikÄlais centrÄ“jums */
                                display: flex;
                                visibility: visible;
                                backdrop-filter: blur(5px); /* Å is pievieno izplÅ«dumu fonam */
								-webkit-backdrop-filter: blur(5px); /* Atbalstam uz vecÄkiem pÄrlÅ«kiem */
                            }


                            #fullscreenMessagetext {
    							background-color: rgba(255, 0, 0, 0.5);
    							 position: relative;
                                color: white;
                                font-size: 2vw;
                                font-weight: bold;
                                padding: 20px 20px;
                                width: 60%;
                                max-width: 90%; 
                                height: auto;
                                text-align: center;
                                border-radius: 10px;
                                border: 2px solid red; 
                                z-index: 50;
                                justify-content: center; 
                                align-items: center; 
                                box-sizing: border-box; 
                            }

							.highlight-title {
                              font-size: 2.5vw; /* Virsraksta lielÄks fonts */
                              color: white; /* KrÄsu var pielÄgot */
                              font-weight: bold; /* Padara virsrakstu treknÄku */
                              text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.5); /* PieÅ¡Ä·ir Ä“nu */
                              display: block; /* Lai veidotu atseviÅ¡Ä·u rindu */
                              margin-bottom: 2px; /* Atstarpes zem virsraksta */
							}

							.copyright {
								display: block; /* Izveido jaunu rindu */
								margin-top: 10px; /* Atstarpe starp linku un tekstu */
								font-size: 1.5vw; /* Nedaudz mazÄks fonts nekÄ virsraksts */
								color: #ffffff; /* Balts teksts (var mainÄ«t) */
								font-weight: normal; /* Parasts fonts (ne trekns) */
								opacity: 0.8; /* Nedaudz caurspÄ«dÄ«gs efekts */
							} 
                            
                            
							.arrow {
    
								border-left: 2.5vh solid transparent;
								border-right: 2.5vh solid transparent;
								border-bottom: 5vh solid red; 
								transform: rotate(0deg); /* Var izmantot rotate, lai mainÄ«tu bultas virzienu */
								position: fixed;
								top: 20px; /* AttÄlums no augÅ¡as */
								right: 56px; /* AttÄlums no kreisÄs puses */
								display: flex;
								animation: bounce 1.5s infinite ease-in-out; /* Pievienota animÄcija */
								 z-index: 10;
							}                 
       
							.arrow::before {
								font-family: 'Noto Sans Symbols', 'Segoe UI Symbol', sans-serif;
								content: "ğ–§µ"; /* Simbols bultiÅ†Ä */
								position: absolute;
								color: white; /* Simbola krÄsa */
								font-size: 2.5vh; /* Simbola izmÄ“rs */
								 transform: scaleX(1.5) scaleY(1); /* Palielina platumu par 1.5x, augstumu nemaina */
								top: 10px; /* Simbola pozÄ«cija virs bultas */
								right: -5px; /* HorizontÄli centrÄ“ simbolu */
								 z-index: 11;
							}
							
							/*arrow animÄcija*/
								@keyframes bounce {
								0% { 
									transform: translateY(0) rotate(0deg); 
								}
								50% { 
									transform: translateY(-15px) rotate(0deg); 
								}
								100% { 
									transform: translateY(0) rotate(0deg); 
								}
							}
    
                            #fullscreenMessage.hidden {
                                visibility: hidden;
                            }
							
							.fs-message-hidden {
								display: none !important;
							}
							
                            :root {
								--vh: 1vh;
							}

							@media (max-width: 1024px) {
								:root {
									--vh: 1vh; 
								}
							}

							.button-container.bottom {
								position: fixed;
								bottom: calc(var(--vh) * 5); /* KoriÄ£Ä“ts, lai vienmÄ“r bÅ«tu 5% no faktiskÄ viewport */
								display: flex;
								gap: 1vw;
								justify-content: center;
								width: 100%;
								z-index: 3;
								pointer-events: none;
								transition: all 0.20s ease-in-out;
							}

							.button-container.left {
								position: fixed;
								left: 2%; /* PrecÄ«zi uz kreiso malu */
								top: auto; /* Atstarpe no augÅ¡as (pielÄgojiet pÄ“c vajadzÄ«bas) */
								display: flex;
								flex-direction: column; /* Pogas no augÅ¡as uz leju */
								gap: 10px; /* Atstarpe starp pogÄm */
								z-index:2;
								transition: all 0.20s ease-in-out;
								pointer-events: none;
							}

							.button-container.right {
								position: fixed;
								right: 2%; /* PrecÄ«zi uz labo malu */
								top: auto; /* Atstarpe no augÅ¡as (pielÄgojiet pÄ“c vajadzÄ«bas) */
								display: flex;
								flex-direction: column; /* Pogas no augÅ¡as uz leju */
								gap: 10px; /* Atstarpe starp pogÄm */
								z-index:2;
								transition: all 0.20s ease-in-out;
								pointer-events: none;
							}

							.position-selector-container {
								position: fixed;
								top: 15%; /* VertikÄli centrÄ“ */
								right: 0%;
								transform: translateY(-50%);
								z-index: 3;
							}

							.position-selector {
								background-color: rgba(0, 0, 0, 0.8); /* CaurspÄ«dÄ«gs melns fons */
								padding: 10px;
								border-radius: 0px 0 0 0px;
								box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
								width: 250px;
								display: flex;
								align-items: center;
								flex-direction: column;
								position: relative;
								transition: transform 0.3s ease-in-out; /* PÄreja paslÄ“pÅ¡anai */
							}

							.position-selector::after {
								content: ''; /* Pievieno pseido-elementu */
								display: block;
								height: 3px; /* LÄ«nijas augstums */
								background-color: rgba(255, 0, 0, 0.8); /* LÄ«nijas krÄsa */
								position: absolute;
								bottom: 0; /* LÄ«nija ir pie apakÅ¡as */
								left: 0%;
								right: 0%;
							}


							.position-selector-left::after  {
								content: ''; /* Pievieno pseido-elementu */
								display: block;
								height: 3px; /* LÄ«nijas augstums */
								background-color: rgba(255, 0, 0, 0.8); /* LÄ«nijas krÄsa */
								position: absolute;
								bottom: 0; /* LÄ«nija ir pie apakÅ¡as */
								left: 0%;
								right: 0%;
							}

							#positionSelect {
								width: 230px;
							}

							.position-selector.hidden {
								transform: translateX(100%); /* PaslÄ“pj logu labajÄ malÄ */
							}

							/* LabÄs puses bultiÅ†a */
							.position-selector-container .toggle-selector {
								position: absolute;
								top: 50%;
								left: -11%;
								transform: translateY(-50%);
								background-color: rgba(255, 0, 51, 0.7);
								border: none;
								color: white;
								border-radius: 10px 0 0 10px; 
								width: 30px;
								height: 100%;
								cursor: pointer;
								font-size: 14px;
								text-align: center;
								line-height: 30px;
							}

							.position-selector-container .toggle-selector:hover {
								background-color: rgba(255, 0, 0, 0.9);
							}

							/* KreisÄs puses bultiÅ†a */
							.position-selector-container-left .toggle-selector-left {
								position: absolute;
								top: 50%;
								right: -30px; 
								transform: translateY(-50%);
								background-color: rgba(255, 0, 51, 0.7);
								border: none;
								color: white;
								border-radius: 0 10px 10px 0; 
								width: 30px;
								height: 100%;
								cursor: pointer;
								font-size: 14px;
								text-align: center;
								line-height: 30px;
							}

							.position-selector-container-left .toggle-selector-left:hover {
								background-color: rgba(255, 0, 0, 0.9);
							}


						

							.position-selector select {
								width: 200px;
								padding: 5px;
								border: none;
								border-radius: 3px;
								font-size: 14px;
								font-size:16px;
								background-color: rgba(0, 0, 0, 0.5);
								color: white;
							}


							label {
								font-weight: bold;
							}


							@media (max-width: 1024px) {
								.button-container {
									bottom: calc(var(--vh) * 5); /* PlanÅ¡etdatoriem tÄds pats nosacÄ«jums */
								}
							}

                            button {
                                background-color: rgba(91, 16, 16, 0.8);
                                color: white;
                                border: none;
                                border-radius: 50%;
                                width: 6vw;
                                height: 6vw;
                                cursor: pointer;
                                display: flex;
                                align-items: center;
                                justify-content: center; /* Centra vertikÄli un horizontÄli */
                                box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
                                pointer-events: auto;
                                overflow: hidden; /* NovÄ“rÅ¡ attÄ“la pÄrlieÅ¡anu Ärpus pogas */
                            }
                            
                            button img {
                                width: 95%; /* PrecÄ«za mÄ“roga kontrole */
                                height: 95%;
                                object-fit: contain; /* NodroÅ¡ina, ka attÄ“ls tiek pilnÄ«bÄ ievietots */
                                display: block;
                                margin: auto; /* Papildu centrÄ“Å¡ana */
                            }
							
							
							button.active {
								transform: scale(1.1); /* Neliels izcÄ“lums */
							}
							
							
							
							
							
							.highlight {
								background-color: #ffcccc;
							}						
							
		
							#lockRotationMode {
								display: none; /* SlÄ“pjam pogu datoros */
							}

							@media (pointer: coarse) { /* Tiek atvÄ“rta tikai uz skÄrienierÄ«cÄ“m */
								#lockRotationMode {
									display: flex; 
								}
							}

							button.active {
								background-color: rgb(187, 1, 1) !important; /* Pogas aktÄ«vais stÄvoklis */
							}

							#toggleFullscreen {
								font-size: 16px;
								transition: background-color 0.3s, color 0.3s;
								background-color: rgba(91, 16, 16, 0.8);
								color: white;
								border: none;
								border-radius: 50%;
								width: 6vw;
								height: 6vw;
								cursor: pointer;
								display: flex;
								align-items: center;
								justify-content: center;
								box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
							}

							#toggleFullscreen img {
								width: 95%; 
								height: 95%;
								object-fit: contain;
							}

							#fullscreenPopup {
								position: fixed;
								bottom: 30px;
								right: 10px;
								color: white;
								padding: 15px;
								border-radius: 5px;
								box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
								z-index: 9999;
								display: none;
								font-weight: bold;
								animation: slide-in 0.5s ease-out;
							}

							/* NodroÅ¡inÄm, ka kompass vienmÄ“r bÅ«s virs kanvas */
							#compassContainer {
							  position: absolute;
							  width: 25vw;
							  height: 14vw;
							  z-index: 3; /* Ä»oti liels z-index, lai pÄrietu pÄri canvasa */
							  transform-origin: center center;
							  pointer-events: none;
							  image-rendering: crisp-edges;
							}

							#rotateCompass90 {
								background-color: rgba(91, 16, 16, 0.8);
								color: white;
								border: none;
								border-radius: 50%;
								width: 6vw;
								height: 6vw;
								cursor: pointer;
								display: flex;
								align-items: center;
								justify-content: center;
								box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
							}
							#rotateCompass90 img {
								width: 95%;
								height: 95%;
							}
							

							#rotateCompass90.active {
								transform: scale(1.1); /* Neliels izcÄ“lums */
							}

							#compassScaleContainer {
							  position: relative; 
							  width: 25vw;
							  height: 14vw;
							  transform-origin: center center;
							  
							  pointer-events: none;
							  image-rendering: crisp-edges; 
							}

							#compassInner {
							  position: absolute;
							  width: 14vw;
							  height: 14vw;
							  left: 41.5%;
							  top: 0%;
							  transform: translate(-50%, -50%);
							  transform-origin: center center;
							  
							  image-rendering: crisp-edges;
							}

							#compassBase {
							  position: absolute;
							  width: 25vw;
							  height: auto;
							  left: 13.5%;
							  top: 50%;
							  transform: translate(-49.9%, -50.2%);
							  transform-origin: center center;
							  display: block;
							 
							  pointer-events: auto;
							  image-rendering: crisp-edges;

							}

							#compassScaleInner {
							  position: absolute;
							  width: 14vw;
							  height: 14vw;
							  left: 41.5%;
							  top: 0%;
							  transform: translate(-50%, -50%) rotate(30deg);
							  transform-origin: center center;
							  
							  border-radius:50%
							  image-rendering: crisp-edges;
							}

							#compassScale {
							  position: absolute;
							  width: 13vw;
							  height: 13vw;
							  left: 50.05%;
							  top: 50.04%;
							  transform: translate(-50%, -50%);
							  transform-origin: center center;
							  
							  display: block;
							  border-radius:50%
							  pointer-events: auto;
							  image-rendering: crisp-edges;
							}

							@keyframes rotateCompassNeedle {
							  from {
								transform: translate(-50%, -50%) rotate(0deg);
							  }
							  to {
								transform: translate(-50%, -50%) rotate(360deg);
							  }
							}

							#compassNeedle {
							  position: absolute;
							  width: 0.65vw;
							  height: auto;
							  left: 69.5%;
							  top: 50%;
							  transform: translate(-50%, -50%);
							  transform-origin: center center;
							  opacity: 0.85;
							  image-rendering: crisp-edges;
							  /* AnimÄcija nepÄrtrauktai rotÄcijai */
							  animation: rotateCompassNeedle 50s linear infinite;
							}
							
							canvas, #compassContainer {
								touch-action: none; /* Disable default touch behavior */
							}


							#compassContainer.with-transition, 
							#compassInner.with-transition, 
							#compassScaleInner.with-transition,
							#compassScaleContainer.with-transition {
								transition: left 0.20s ease-in-out, 
											top 0.20s ease-in-out, 
											transform 0.40s ease-in-out;
							}

							#mapCanvas.with-transition {
								transition: transform 0.5s ease-in-out;
							}

							#about {
								position: fixed;
								bottom: calc(var(--vh) * 0); /* KoriÄ£Ä“ts, lai vienmÄ“r bÅ«tu 5% no faktiskÄ viewport */
								display: flex;
								gap: 2vw;
								justify-content: center;
								width: 100%;
								z-index: 2;
								
								padding:0.3vw;
								background-color: rgba(0, 0, 0, 0.8);
								color: rgba(255, 255, 255, 0.8);
								text-align:center;
								z-index:20;
							}

							.abouttext {
								font-size: 15px; /* IzvÄ“lies piemÄ“rotu teksta izmÄ“ru */
								margin: 10px 0; /* Atstarpe starp tekstiem */
								text-align: center; /* Centrs katra rinda atseviÅ¡Ä·i */
								margin-top: 1px;
								margin-bottom: 1px;
							}


							/* KreisÄs puses konteineris */
							.position-selector-container-left {
								position: fixed;
								top: 15%; /* VertikÄli centrÄ“ */
								left: 0; /* KreisajÄ malÄ */
								transform: translateY(-50%);
								z-index: 3;
							}

							/* IzvÄ“lne un tÄs stils */
							.position-selector-left {
								background-color: rgba(0, 0, 0, 0.8); /* CaurspÄ«dÄ«gs melns fons */
								padding: 10px;
								border-radius: 0 0px 0px 0; /* KreisÄs puses stÅ«ri noapaÄ¼oti */
								box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
								width: 250px;
								display: flex;
								align-items: center;
								flex-direction: column;
								position: relative;
								transition: transform 0.3s ease-in-out; /* PÄreja paslÄ“pÅ¡anai */
							}

							/* KreisÄs puses slÄ“pÅ¡anas animÄcija */
							.position-selector-left.hidden-left {
								transform: translateX(-100%); /* PilnÄ«bÄ paslÄ“pta kreisajÄ malÄ */
							}

							.position-selector-left {
								transform: translateX(0); /* Redzama */
							}



							/* KreisÄs puses bultiÅ†a */
							.toggle-selector-left {
								position: absolute;
								top: 50%;
								right: -7%; /* BultiÅ†a atrodas pie kreisÄs puses malÄ */
								transform: translateY(-50%);
								background-color: rgba(255, 0, 51, 0.7);
								border: none;
								color: white;
								border-radius: 0 10px 10px 0; /* Tikai labÄ puse noapaÄ¼ota */
								width: 30px;
								height: 100%;
								cursor: pointer;
								font-size: 14px;
								text-align: center;
								line-height: 30px;
							}

							/* Hover efekts bultiÅ†ai */
							.toggle-selector-left:hover {
								background-color: rgba(255, 0, 0, 0.9);
							}

							/* IzvÄ“les lodziÅ†Å¡ */
							.position-selector-left select {
								width: 230px;
								padding: 5px;
								border: none;
								border-radius: 3px;
								font-size: 16px;
								background-color: rgba(0, 0, 0, 0.5);
								color: white;
							}
							
							.position-selector-left select option {
								background-color: rgba(0, 0, 0, 0.6); /* Fona krÄsa opcijÄm */
								color: white; /* Teksta krÄsa opcijÄm */
								border: 2px solid red; 
								border-radius: 4px;
							}
							
							.position-selector select option {
								background-color: rgba(0, 0, 0, 0.6); /* Fona krÄsa opcijÄm */
								color: white; /* Teksta krÄsa opcijÄm */
								border: 2px solid red; 
								border-radius: 4px;
							}

							/* PilnekrÄna pÄrklÄjums */
							#orientation-overlay {
								display: none; /* SÄkumÄ paslÄ“pts */
								position: fixed;
								top: 0;
								left: 0;
								width: 100%;
								height: 100%;
								background-color: #000; /* Melns fons */
								color: #fff; /* Balts teksts */
								text-align: center;
								z-index: 9999; /* Virs visiem citiem elementiem */
								display: flex;
								flex-direction: column;
								justify-content: center;
								align-items: center;
								font-size: 1.5em;
							}

							#orientation-overlay img {
								width: 100%;
								height: auto;
								margin-top: 20px;
							}


						   #mobile-warning {
								position: fixed;
								top: 0;
								left: 0;
								width: 100%;
								height: 100%;
								background-color: rgba(0, 0, 0, 0.9); /* TumÅ¡s fons */
								color: white;
								display: flex;
								justify-content: center;
								align-items: center;
								text-align: center;
								font-size: 1.5em;
								z-index: 9999;
							}

							.warning-content img {
								max-width: 300px;
								height: auto;
							}

							
							/* UznirstoÅ¡ais ziÅ†ojums */
							#touchscreenPopup {
								position: fixed;
								bottom: 30px;
								right: 10px;
								color: white;
								padding: 15px;
								border-radius: 5px;
								box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
								z-index: 9999;
								display: none;
								font-weight: bold;
								animation: slide-in 0.5s ease-out;
							}

							@keyframes slide-in {
								from {
									transform: translateX(100%);
								}
								to {
									transform: translateX(0);
								}
							}

							.popup-success {
								background-color: #28a745; /* ZaÄ¼Å¡ fons, kad pievieno */
							}

							.popup-error {
								background-color: #dc3545; /* Sarkans fons, kad atvieno */
							}

							.touch-only {
								display: none; /* SÄkotnÄ“ji paslÄ“pta */
							}

							.touch-visible {
								display: block !important; /* ParÄdÄ«ta, kad ir aktÄ«va skÄrienjÅ«tÄ«gÄ ierÄ«ce */
							}				
							


							/* Popup stils */
							#popupMenu {
								position: fixed;
								top: 50%;
								left: 50%;
								transform: translate(-50%, -50%);
								padding: 10px;
								background-color: rgba(0, 0, 0, 0.8);
								color: white;
								border-radius: 10px;
								text-align: center;
								z-index: 9;
								width: 30vw;
								height: auto;
								display: flex;
								flex-direction: column;
								align-items: center;
								gap: 1vw;
								justify-content: center;
							}

							/* Virsraksta stils */
							#popupMenu p {
								margin-bottom: 15px;
								font-size: 1.2em;
								font-weight: bold;
							}

							/* Pogas rinda */
							#popupMenu .button-row {
								display: flex;
								justify-content: center;
								gap: 20px; /* Atstarpes starp pogÄm */
								margin-top: 10px;
							}

							/* Pogas stils */
							#popupMenu button {
								margin: 0;
								padding: 0;
								cursor: pointer;
								background-color: transparent; 
								border: none;
								border-radius: 15px;
								width: 10vw; /* PalielinÄts pogas platums */
								height: 10vw; /* PalielinÄts pogas augstums */
								display: flex;
								align-items: center;
								justify-content: center;
								transition: background-color 0.3s, transform 0.2s;
							}

							#popupMenu button:hover {
								background-color: rgba(255, 255, 255, 0.1);
								border-radius: 15px;
								transform: scale(1.1); /* Palielina pogu pie hover */
							}

							/* Pogas attÄ“li */
							#popupMenu button img {
								width: 9vw; /* PalielinÄts attÄ“la platums */
								height: 9vw; /* PalielinÄts attÄ“la augstums */
								object-fit: contain; /* PÄrliecinÄs, ka attÄ“ls ir pilnÄ«bÄ redzams pogÄ */
								border-radius:10px;
							}

							#resizeHandle {
								display: none;
								align-items: center; /* VertikÄli centrÄ“ attÄ“lu */
								justify-content: center; /* HorizontÄli centrÄ“ attÄ“lu */	 
								width: 12px;
								height: 12px;
								border-radius:5px;
								position: absolute;
								background-color:rgba(255, 0, 0, 0.5);
								cursor: se-resize;
								z-index: 5;
							}

							#resizeHandle img {
								width: 90%; /* NodroÅ¡ina, ka attÄ“ls pilnÄ«bÄ aizpilda rokturi */
								height: 90%; /* NodroÅ¡ina, ka attÄ“ls pilnÄ«bÄ aizpilda rokturi */
								object-fit: contain; /* NodroÅ¡ina, ka attÄ“ls tiek saglabÄts proporcijÄs */
								pointer-events: none; /* NeÄ¼auj attÄ“lam bloÄ·Ä“t klikÅ¡Ä·us */
								
								
							}





							/* AugÅ¡Ä“jÄs nolaiÅ¾amÄs joslas stils */
							.top-bar {
								position: fixed;
								top: 0;
								left: 0;
								width: 100%;
								background-color: transparent;
								color: white;
								padding: 0px;
								display: flex;
								justify-content: space-between;
								align-items: center;
								z-index: 20;
								transition: top 0.3s ease-in-out;
								backdrop-filter: none;
								transition: height 0.3s ease-in-out, padding 0.3s ease-in-out;
							}



							.top-bar .dropdown-toggle {
								background-color: rgba(255, 0, 51, 0.7);
								border: none;
								color: white;
								padding: 3px;
								cursor: pointer;
								font-size: 20px;
								border-radius: 0 0 5px 5px; /* Tikai apakÅ¡Ä“jie stÅ«ri */
								transition: background-color 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
								width: 49%;
								text-align: center;
								display: block;
							}

							.top-bar .dropdown-toggle:hover {
								background-color: rgba(255, 0, 0, 0.9);
							}

							.top-bar .dropdown-toggle.active {
								box-shadow: 0px 0px 10px rgba(255, 0, 51, 0.8);
							}

							.top-bar .dropdown-toggle:first-child {
								margin-right: 10px;
							}

							.dropdown-menu {
								position: fixed;
								top: -100%;
								left: 0;
								width: 100%;
								height: calc(100vh - 40px);
								background-color: rgba(0, 0, 0, 0.8);
								padding: 20px;
								display: flex;
								flex-wrap: wrap;
								justify-content: center;
								align-items: center;
								box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
								transition: top 0.4s ease-in-out;
								   visibility: hidden;
							}

							.dropdown-menu a {
								color: white;
								text-decoration: none;
								padding: 15px 20px;
								font-size: 20px;
								text-align: center;
								transition: background-color 0.3s ease-in-out;
								display: flex;
								align-items: center;
								justify-content: center;
								width: 30%;
								height: 50px;
								margin: 10px;
								background-color: rgba(50, 50, 50, 0.8);
								border-radius: 5px;
							}

							.dropdown-menu a:hover {
								background-color: rgba(255, 0, 51, 0.7);
								color: white;
							}

							.dropdown-container {
								position: fixed;
								top: 0;
								left: 0;
								z-index: 10;
								width: 100%;
								 background-color: transparent;
							}

							.dropdown-menu.visible {
								top: -20px;
								margin-left:-18px;
								visibility: visible;
								 transition: top 0.4s ease-in-out, opacity 0.4s ease-in-out; /* NoÅ†emam delay */
							}





							/* Kad aizveras */
							.dropdown-menu:not(.visible) {
							    top: -100%;
							    opacity: 0;
							    visibility: hidden;
							    transition: top 0.4s ease-in-out, opacity 0.4s ease-in-out, visibility 0s 0.4s; /* Visibility delay, lai paslÄ“ptu tikai pÄ“c animÄcijas */
							}


							/* Kad iframe ir aktÄ«vs, dropdown pogas tiek paceltas un samazinÄtas */
							.dropdown-menu.shrink .dropdown-link {
								padding: 5px 1px;
								font-size: 14px;
								height: 20px;
								transform: translateY(70px); /* PaceÄ¼ pogas augstÄk, bet saglabÄ rindu izvietojumu */
								margin-top:-40px;
							}


							@media (max-width: 768px) {
								.top-bar {
									flex-direction: column;
									align-items: center;
								}

								.top-bar .dropdown-toggle {
									width: 100%;
									margin-bottom: 5px;
								}

								.dropdown-menu {
									flex-direction: column;
									height: auto;
									max-height: 60vh;
									overflow-y: auto;
									
								}

								.dropdown-menu a {
									width: 90%;
									font-size: 18px;
									padding: 12px;
								}
							}



							.dropdown-menu a {
								transition: padding 0.3s ease-in-out, font-size 0.3s ease-in-out, height 0.3s ease-in-out;
								padding: 15px 20px;
								font-size: 20px;
								height: 50px;
								margin-top: 10px; /* NoklusÄ“juma attÄlums no augÅ¡as */
							}

							.dropdown-menu.shrink a {
								padding: 5px 10px;
								font-size: 14px; /* MazÄks teksts */
								height: 30px; /* SamazinÄts augstums */
								margin-top: 60px; /* PÄrvieto pogas augstÄk */
							}


							/* NoklusÄ“juma iframe stils */
							#contentFrame {
								transition: height 0.3s ease-in-out, margin-top 0.3s ease-in-out;
								width: 100%;
								height: 0; /* SÄkumÄ paslÄ“pts */
								border: none;
								display: block;
								margin-top: 0px;
							}

							/* Kad iframe ir aktÄ«vs, tas kÄ¼Å«st lielÄks un paceÄ¼as */
							#contentFrame.active {
								height: 75vh; /* PalielinÄts augstums lÄ«dz 85% no ekrÄna augstuma */
								margin-top: 20px; /* PaceÄ¼ nedaudz uz augÅ¡u */
								margin-bottom: -40px;
							}



							/* Atsauksmju poga */
							.aboutlink {
								display: inline-block;
								padding: 5px 10px;
								background-color: #d0021b; /* Sarkans tonis */
								color: white;
								font-weight: bold;
								text-decoration: none;
								border-radius: 5px 5px 0 0;
								transition: all 0.3s ease-in-out;
								position: absolute; /* PÄrliecinÄs, ka tÄ paliek konteinera robeÅ¾Äs */
								right: 10px; /* Novieto pareizi */
								top: 0px;
								z-index: 5;
								width: 170px;
							}


							.aboutlink:hover {
								background-color: rgba(255, 0, 51, 1);
								transform: scale(1.05);
							}

							#iframeContainerAbout {
								position: fixed;
								width: 500px;
								height: 600px;
								bottom: -620px; /* SÄkumÄ paslÄ“pts zem ekrÄna */
								right: 20px;
								background: white;
								box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
								border-radius: 8px;
								overflow: hidden;
								transition: bottom 0.5s ease-in-out; /* SlÄ«dÄ“Å¡anas animÄcija */
								display: none;
								z-index: 9999;
							}

							#iframeContainerAbout iframe {
								width: 100%;
								height: 100%;
							}

							/* AizvÄ“rÅ¡anas poga */
							#closeIframeAbout {
								position: absolute;
								top: 5px;
								right: 5px;
								background: red;
								color: white;
								border: none;
								width: 25px;
								height: 25px;
								border-radius: 50%;
								font-size: 14px;
								cursor: pointer;
							}



							#iframeContainerQR {
								position: fixed;
								width: 300px;
								height: 330px;
								bottom: -370px; /* SÄkumÄ paslÄ“pts zem ekrÄna */
								left: 20px; /* Novietots kreisajÄ pusÄ“ */
								background: rgba(0, 0, 0, 0.8);;
								box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
								border-radius: 8px;
								overflow: hidden;
								transition: bottom 0.5s ease-in-out;
								display: none;
								z-index: 20;
								text-align: center;
								padding: 20px;
								
							}

							#qrCodeContent {
								text-align: center;
							}

							.qrTitle {
								font-size: 18px;
								font-weight: bold;
								margin-bottom: 10px;
								color: white;
							}

							#qrCodeImage {
								width: 250px;
								height: 250px;
							}

							#closeIframeQR {
								position: absolute;
								top: 5px;
								right: 5px;
								background: red;
								color: white;
								border: none;
								width: 25px;
								height: 25px;
								border-radius: 50%;
								font-size: 14px;
								cursor: pointer;
							}

							.qrLink {
								display: inline-block;
								padding: 5px 10px;
								background-color: #d0021b; /* Sarkans tonis */
								color: white;
								font-weight: bold;
								text-decoration: none;
								border-radius: 5px 5px 0 0;
								transition: all 0.3s ease-in-out;
								position: absolute;
								left: 10px;
								bottom: -2px;
								z-index: 5;
								width: 170px;
							}

							.qrLink:hover {
								background-color: rgba(255, 0, 51, 1);
								transform: scale(1.05);
							}



							/* Labo dropdown pogu novietojumu tikai LietotÄja ceÄ¼vedim */
							#dropdownInstruction.shrink .dropdown-toggle {
								transform: translateY(30px); /* Samazina pÄrvietojumu */
							}

							/* LietotÄja ceÄ¼veÅ¾a iframe pielÄgoÅ¡ana */
							#instructionFrame.active {
								height: 75vh; 
								display: block;
								margin-top: 10px; /* Samazina augÅ¡Ä“jo attÄlumu */
							}


							/* === DOCK (tikai #buttonContainer) â€” jauns dizains bez loÄ£ikas maiÅ†as === */
							:root{
							  --dock1:#1b1f25; --dock2:#490000a8;
							  --dock-ring:#8b0202; --dock-icon:#eef2f7; --dock-muted:#3a3f47;
							  --dock-shadow:0 12px 28px rgba(0,0,0,.45),0 2px 6px rgba(0,0,0,.35);
							  --tipX:50%; --tipY:50%;
							  --labelW:210px; --capH:32px; --capSkew:14px; --capR:10px; --capExtraW:10px; --labelOffsetY:2px;
							}
							
							/* â€œÄŒaulaâ€ ap paÅ¡Äm pogÄm (izveidosim ar JS), lai fona kapsula bÅ«tu pÄ“c satura platuma */
							#buttonContainer { pointer-events:none;}
							#buttonContainer .dock-shell{
							  position:relative; display:flex; gap:22px; align-items:center;
							  padding:14px 18px; border-radius:48px;
							  backdrop-filter:blur(6px); -webkit-backdrop-filter:blur(6px);
							  background:linear-gradient(180deg,var(--dock1),var(--dock2));
							  border:1px solid rgba(255,255,255,.04);
							  box-shadow:var(--dock-shadow);  
							  pointer-events:auto; /* lai var klikÅ¡Ä·inÄt pogas */
							}
							
							
							/* lai auto-fit mÄ“rogs izskatÄs pareizi visos novietojumos */
							#buttonContainer .dock-shell{ 
							  transform-origin: center center; 
							  will-change: transform; 
							}
							#buttonContainer.left  .dock-shell{ transform-origin: left  center; }
							#buttonContainer.right .dock-shell{ transform-origin: right center; }
							
							
							
							/* orientÄcijas mantoÅ¡ana no TavÄm klasÄ“m */
							#buttonContainer.bottom .dock-shell{ flex-direction:row; }
							#buttonContainer.left  .dock-shell,
							#buttonContainer.right .dock-shell{ flex-direction:column; }
							
							/* EtiÄ·ete (teksta burbulis) + kupola SVG (horizontÄlajam reÅ¾Ä«mam) */
							#buttonContainer .dock-label{
							  position:absolute; left:0; top:calc(-1 * var(--capH) - var(--labelOffsetY));
							  transform:translateX(calc(var(--tipX) - 50%));
							  max-width:var(--labelW);
							  padding:6px 12px; background:rgba(22,25,30, 0.8);
							  border:1px solid rgba(210,34,34,.45); border-radius:var(--capR);
							  color:#fff; font-size:13px; line-height:1.05; font-weight:600;
							  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
							  box-shadow:0 8px 20px rgba(0,0,0,.35);
							  backdrop-filter:blur(6px); -webkit-backdrop-filter:blur(6px);
							  opacity:0; pointer-events:none; z-index:3;
							  clip-path: inset(0 50% 0 50% round var(--capR));
							  transition:opacity .18s, clip-path .24s, max-width .12s;
							}
							#buttonContainer .show-label .dock-label{
							  opacity:1; clip-path: inset(0 0 0 0 round var(--capR));
							}
							#buttonContainer .dock-cap{
							  position:absolute; left:0; top:calc(-1 * var(--capH));
							  width:calc(var(--labelW) + 22px + var(--capExtraW)); height:var(--capH);
							  transform:translateX(calc(var(--tipX) - 50%));
							  transform-origin:bottom center;
							  opacity:0; pointer-events:none; z-index:1;
							  filter:drop-shadow(0 10px 18px rgba(0,0,0,.35));
							}
							#buttonContainer .show-cap .dock-cap{ opacity:1; }
							
							/* VertikÄlie novietojumi: etiÄ·ete slÄ«d vertikÄli un stÄv sÄnis (kupolu slÄ“pjam) */
							#buttonContainer.left  .dock-cap,
							#buttonContainer.right .dock-cap{ display:none; }
							#buttonContainer.left  .dock-label,
							#buttonContainer.right .dock-label{
							  top:0; transform:translateY(calc(var(--tipY) - 50%));
							}
							#buttonContainer.left  .dock-label{ left:100%; margin-left:12px; }
							#buttonContainer.right .dock-label{ right:100%; left:auto; margin-right:12px; }
							
							/* Pogu stils #buttonContainer iekÅ¡ienÄ“ (pÄrraksta globÄlo â€œbuttonâ€ izskatu tikai Å¡eit) */
							#buttonContainer .dock-shell > button{
							  position:relative; background:transparent !important; color:var(--dock-icon);
							  border:none; border-radius:50%;
							  width:64px; height:64px; /* mobilajam var samazinÄt ar @media */
							  display:grid; place-items:center; cursor:pointer; outline:none;
							  -webkit-tap-highlight-color:transparent;
							}
							#buttonContainer .dock-shell > button::before{
							  content:""; position:absolute; inset:0; border-radius:50%;
							  border:3px solid var(--dock-ring); box-shadow:0 6px 16px rgba(210,34,34,.35);
							  transition:transform .18s ease, opacity .18s ease, border-color .18s ease, box-shadow .18s ease;
							}
							#buttonContainer .dock-shell > button:active::before{ transform:scale(.95); opacity:.9; }
							#buttonContainer .dock-shell > button img{
							  width:78%; height:78%; object-fit:contain; display:block; margin:auto; pointer-events:none;
							}
							/* AktÄ«vajÄm (TavÄ kodÄ tiek pievienota .active) â€“ neliels izcelums */
							#buttonContainer .dock-shell > button.active::before{
							  border-color:#ff0000; box-shadow:0 0 0 4px rgba(255,77,77,.12);
							}
							/* â€œTouch-onlyâ€ pogas paliek kÄ ir â€“ tikai izmÄ“rs/dizains vienots */
							#buttonContainer .dock-shell > .touch-only{ display:none; }
							@media (pointer:coarse){
							  #buttonContainer .dock-shell > .touch-only{ display:grid; }
							}
							
							/* Mazi skatlogi */
							@media (max-width:540px){
							  #buttonContainer .dock-shell{ gap:16px; padding:12px 14px; }
							  #buttonContainer .dock-shell > button{ width:58px; height:58px; }
							}

							/* === REGULATORI vienuviet === */
							:root{
							  /* cik liela strÄ“mele paliek redzama, kad paslÄ“pts */
							  --expose-bottom: 28px; /* apakÅ¡a */
							  --expose-left:   -2vw;  /* kreisÄ mala */
							  --expose-right:  -2vw;  /* labÄ mala */
							
							  /* kad KONTEINERS ir atvÄ“rts apakÅ¡Ä â€“ atstarpe no ekrÄna malas */
							  --bottom-offset: 50px;
							}
							
							/* === DRAWER/ROKTURIS priekÅ¡ #buttonContainer === */
							#buttonContainer{
							  --handle-w: 45px;  /* roktura platums */
							  --handle-h: 45px;  /* roktura augstums */
							  transition: transform .28s ease;
							  z-index: 3;
							}
							@media (pointer:coarse){
							  #buttonContainer{ --handle-w: 52px; --handle-h: 52px; }
							}
							
							#buttonContainer .dock-handle{
							  position:absolute;
							  width: var(--handle-w);
							  height: var(--handle-h);
							  display:none; /* redzams tikai dokÄ“tÄ reÅ¾Ä«mÄ */
							  align-items:center;
							  justify-content:center;
							  background: linear-gradient(180deg, #dd2222a1, #b01616);
							  color:#fff;
							  font-size: 0;           /* ikonai lietosim SVG, nevis tekstu */
							  border-radius:10px;
							  box-shadow:0 8px 18px rgba(0,0,0,.35);
							  border:1px solid rgba(255,255,255,.25);
							  cursor:pointer;
							  pointer-events:auto;
							  user-select:none;
							}
							
							/* pÄ“c roktura izmÄ“ra: */
							#buttonContainer .dock-handle svg{
							  width:  calc(var(--handle-w) * .74);
							  height: calc(var(--handle-h) * .74);
							}
							
							
							/* Kad dokÄ“ts â€” rokturis parÄdÄs */
							#buttonContainer.docked .dock-handle{ display:flex; }
							
							/* Roktura novietojums atkarÄ«bÄ no orientÄcijas */
							#buttonContainer.bottom .dock-handle{
							  top:0; left:50%; transform: translate(-50%, -100%);
							  border-radius:10px 10px 0 0;
							}
							#buttonContainer.left .dock-handle{
							  top:50%; right:0; transform: translate(100%, -50%);
							  border-radius:0 10px 10px 0;
							}
							#buttonContainer.right .dock-handle{
							  top:50%; left:0; transform: translate(-100%, -50%);
							  border-radius:10px 0 0 10px;
							}
							
							.button-container.bottom {
							  bottom: calc(var(--vh) * 5); /* optional fallback */
							}

							
							/* PaslÄ“pÅ¡ana ar â€œatvilkniâ€: atstÄj redzamu tieÅ¡i expose-* */
							#buttonContainer.docked.bottom{
							  transform: translateY(calc(100% + var(--bottom-offset) - var(--expose-bottom)));
							}
							#buttonContainer.docked.left{
							  transform: translateX(calc(-100% + var(--expose-left)));
							}
							#buttonContainer.docked.right{
							  transform: translateX(calc(100% - var(--expose-right)));
							}



/* === DIMMER (slÄ«dnis) â€” izkÄrtojums un izmÄ“ri === */

/* KopÄ lietojam GRID â€“ tas Ä¼auj slÄ«dnim sÄnÄ izstiepties tieÅ¡i tik augstu, cik aizÅ†em pogas */
#buttonContainer .dock-shell{
  display:inline-grid;
  grid-column-gap:22px;
  grid-row-gap:12px;
  align-items:center;
}

/* ApakÅ¡a: pogas 1. rindÄ, slÄ«dnis 2. rindÄ un platumÄ = tieÅ¡i tik, cik plata ir pogu rinda */
#buttonContainer.bottom .dock-shell{
  grid-auto-flow:column;
  grid-auto-columns:max-content;   /* kolonnas pÄ“c satura (pogas) */
}
#buttonContainer.bottom .dock-shell > button{ grid-row:1; }
#buttonContainer.bottom .dock-dimmer{
  grid-column:1 / -1;
  grid-row:2;
  width:100%;
  max-width:100%;
}

/* SÄni: 2 kolonnas â€“ slÄ«dnis + pogas. SlÄ«dnis stiepjas pÄri VISÄ€ pogu kolonnas augstumÄ */
#buttonContainer.left .dock-shell,
#buttonContainer.right .dock-shell{
  display:grid;
  grid-auto-flow:row dense;          /* bez spraugÄm */
  grid-auto-rows:max-content;        /* katra pogas rinda pÄ“c satura */
  grid-template-columns:auto auto;   /* slÄ«dnis | pogas (vai otrÄdi) */
  align-items:start;
}

/* Kreiso/labo pusi samainÄm vietÄm kÄ prasÄ«ji â€” FIX: span 999, nevis -1 */
#buttonContainer.left  .dock-dimmer{
  grid-column:1;
  grid-row:1 / span 999;   /* <-- svarÄ«gi, lai nosegtu arÄ« implicitÄs rindas */
  align-self:stretch;
}
#buttonContainer.left  .dock-shell > button{ grid-column:2; }

#buttonContainer.right .dock-shell > button{ grid-column:1; }
#buttonContainer.right .dock-dimmer{
  grid-column:2;
  grid-row:1 / span 999;   /* <-- svarÄ«gi, lai nosegtu arÄ« implicitÄs rindas */
  align-self:stretch;
}

/* Dimmera â€œkasteâ€ ar to paÅ¡u stilu kÄ dokam */
#buttonContainer .dock-dimmer{
  box-sizing:border-box;
  display:flex;
  flex-direction:row;
  align-items:center;
  gap:10px;
  padding:8px 10px;
  background:linear-gradient(180deg, var(--dock1), var(--dock2));
  border:1px solid rgba(255,255,255,.06);
  border-radius:18px;
  box-shadow:var(--dock-shadow);
  backdrop-filter:blur(6px);
  -webkit-backdrop-filter:blur(6px);
  max-width:100%;
  pointer-events:auto;
  min-height:0;               /* Safari 100% augstuma fix */
}

/* VertikÄlajÄs malÄs iekÅ¡Ä liekam kolonnu, lai â€œrangeâ€ var izstiepties */
#buttonContainer.left  .dock-dimmer,
#buttonContainer.right .dock-dimmer{
  flex-direction:column;
  justify-content:center;
}

/* SlÄ“pjam iekÅ¡Ä“jos uzrakstus (vÄ“rtÄ«bu/label) â€“ tooltips rÄdÄ«sies ÄrpusÄ“ */
#buttonContainer .dock-dimmer label,
#buttonContainer .dock-dimmer .dimmer-label,
#buttonContainer .dock-dimmer .value{
  display:none !important;
}

/* Range: apakÅ¡Ä â€“ 100% platumÄ */
#buttonContainer .dock-dimmer input[type=range]{ width:100%; max-width:100%; }

/* Range: sÄnos â€“ vertikÄls un vizuÄli tik garÅ¡, cik augsta ir pogu kolonna */
#buttonContainer.left  .dock-dimmer input[type=range],
#buttonContainer.right .dock-dimmer input[type=range]{
  height:calc(100% - 16px);  /* 8px top + 8px bottom padding */
  min-height:0;
  width:28px;
  writing-mode:bt-lr;
  -webkit-appearance:slider-vertical;
}

@supports not (-webkit-appearance: slider-vertical){
  #buttonContainer.left  .dock-dimmer input[type=range],
  #buttonContainer.right .dock-dimmer input[type=range]{
    height:28px;
    width:100%;
    transform:rotate(-90deg);
    transform-origin:center;
  }
}

/* Vienotais track/thumb dizains */
#buttonContainer .dock-dimmer input[type=range]::-webkit-slider-runnable-track{
  height:8px;border-radius:999px;
  background:linear-gradient(180deg,var(--dock1),var(--dock2));
  border:1px solid rgba(255,255,255,.06);
}
#buttonContainer .dock-dimmer input[type=range]::-webkit-slider-thumb{
  -webkit-appearance:none;
  width:18px;height:18px;border-radius:50%;
  background:var(--dock-icon);
  border:3px solid var(--dock-ring);
  box-shadow:0 2px 6px rgba(0,0,0,.35);
  margin-top:-5px;
}
#buttonContainer .dock-dimmer input[type=range]::-moz-range-track{
  height:8px;border-radius:999px;
  background:linear-gradient(180deg,var(--dock1),var(--dock2));
  border:1px solid rgba(255,255,255,.06);
}
#buttonContainer .dock-dimmer input[type=range]::-moz-range-thumb{
  width:18px;height:18px;border-radius:50%;
  background:var(--dock-icon);
  border:3px solid var(--dock-ring);
  box-shadow:0 2px 6px rgba(0,0,0,.35);
}


						</style>
					</head>
						<body>

							<!-- BrÄ«dinÄjuma pÄrklÄjums viedtÄlruÅ†iem -->
							<div id="mobile-warning" style="display: none;">
								<div class="warning-content">
									<p>LÅ«dzu, izmantojiet lielÄku ekrÄnu Å¡Ä«s lietotnes darbÄ«bai.</p>
									<img style="width:100px; height:auto;" src="https://site-710050.mozfiles.com/files/710050/fullscreen-11-xxl.png" alt="Nepietiekams ekrÄna izmÄ“rs" style="width: 80%; margin-top: 20px;">
									<p>INTERAKTÄªVAIS KOMPASS</p>
									<p style="color: rgba(255, 255, 255, 0.5);">CADET.LV | Â© JÄnis Eglis</p>
								</div>
							</div>

							<!-- PÄrklÄjums mobilajÄm ierÄ«cÄ“m vertikÄlÄ reÅ¾Ä«mÄ -->
							<div id="orientation-overlay">
								<h1><img src="https://site-710050.mozfiles.com/files/710050/medium/Rotate_V5-2.jpg" alt="Pagrieziet ierÄ«ci"></h1>
							</div>						

							<div id="fullscreenMessage" class="fs-message-hidden">
								<div class="arrow"></div>
								<p id="fullscreenMessagetext">
									<span class="highlight-title">LÅ«dzu, iestatiet logu pilnÄ izmÄ“rÄ, lai sÄktu darbu.</span>
									<br>
									Varat izmantot F11, lai logu darbinÄtu pilnekrÄna reÅ¾Ä«mÄ vai palielinÄt logu lÄ«dz ekrÄna izmÄ“ram spieÅ¾ot simbolu "ğ–§µ" pÄrlÅ«ka galvenÄ“.<br><br>
									<a href="https://cadet.lv" target="_blank" style="color: white; font-weight: bold;">CADET.LV</a>
									<br>
									<span style="color: " class="copyright">CADET.LV | Â© JÄnis Eglis</span>
								</p>
							</div> 
							
							<div id="touchscreenPopup"></div>
							
							<div id="fullscreenPopup"></div>

													
							<div id="canvasContainer" 
								 style="position: fixed; 
										width: 1920px; 
										height: 1080px;">

							  <!-- kanva kartei -->
							  <canvas id="mapCanvas" width="1920" height="1080" style="display:block; width:100%; height:100%;"></canvas>

							  <!-- Jaunais <img>, kur glabÄt augÅ¡upielÄdÄ“to attÄ“lu -->
							  <img id="uploadedImg" 
								   src="" 
								   alt="AugÅ¡upielÄdÄ“tais attÄ“ls"
								   style="
									 position: absolute;
									 top: 0;
									 left: 0;
									 display: none; /* SlÄ“pts lÄ«dz augÅ¡upielÄdÄ“ attÄ“lu */
									 cursor: move;  /* Ja vÄ“laties, var padarÄ«t arÄ« pÄrvietojamu */
									  
									 ">
									 

							  <!-- MapResize rokturis -->
								<div id="resizeHandle">
									<img src="https://site-710050.mozfiles.com/files/710050/resize_map__1_.png" alt="Resize">
								</div>
							</div>

																			
							<!-- MapResize Papildu elements attÄ“lam -->
							<img id="newUploadedImg" 
								 style="
								   position: absolute; 
								   top: 50px; 
								   left: 50px; 
								   display: none;
								   cursor: move;
								   
								 " 
								 alt="AugÅ¡upielÄdÄ“tais attÄ“ls">

							<!-- MapResize rokturis -->
							<div id="newResizeHandle"
								 style="
								   display: none;
								   width: 30px;
								   height: 30px;
								   position: absolute;
								   cursor: se-resize;
								   z-index: 9;
								 ">
							</div>						
							

							<div class="dropdown-container">
							        <div class="top-bar">
							            <span class="dropdown-toggle" id="toggleInstruction">LietotÄja ceÄ¼vedis â¬‡</span>
							            <span class="dropdown-toggle" id="toggleMaterials">MÄcÄ«bu materiÄli â¬‡</span>
							        </div>
							
							        <div class="dropdown-menu" id="dropdownInstruction">
							            <a href="https://cadet.mozello.lv/virtualais-kompass-macibu-materiali-un-instrukcija/lietotaja-celvedis/page/">DARBAM AR DATORU</a>
							            <a href="https://cadet.mozello.lv/virtualais-kompass-macibu-materiali-un-instrukcija/lietotaja-celvedis/page-1/">DARBAM AR SKÄ€RIENJÅªTÄªGÄ€M IERÄªCÄ’M</a>
										<a href="https://cadet.mozello.lv/virtualais-kompass-macibu-materiali-un-instrukcija/lietotaja-celvedis/page-2/">LIETOÅ ANAS NOTEIKUMI</a>
							           <iframe id="instructionFrame" name="contentFrame" style="width: 100%; height: 85vh; border: none;"></iframe>  
							            
							        </div>
							
							        <div class="dropdown-menu" id="dropdownMaterials">
							        <a href="https://cadet.mozello.lv/virtualais-kompass-macibu-materiali-un-instrukcija/macibu-materiali/topografiskas-kartes/" class="dropdown-link">TOPOGRÄ€FISKÄ€S KARTES</a>
							        <a href="https://cadet.mozello.lv/virtualais-kompass-macibu-materiali-un-instrukcija/macibu-materiali/merogs-un-attalumi/" class="dropdown-link">MÄ’ROGS UN ATTÄ€LUMI</a>
							        <a href="https://cadet.mozello.lv/virtualais-kompass-macibu-materiali-un-instrukcija/macibu-materiali/apzimejumi-kartes/" class="dropdown-link">APZÄªMÄ’JUMI KARTÄ’S</a>
							        <a href="https://cadet.mozello.lv/virtualais-kompass-macibu-materiali-un-instrukcija/macibu-materiali/direkcijas-lenkis-un-azimuts/" class="dropdown-link">DIREKCIJAS LEÅ…Ä¶IS UN AZIMUTS</a>
							        <a href="https://cadet.mozello.lv/virtualais-kompass-macibu-materiali-un-instrukcija/macibu-materiali/koordinates/" class="dropdown-link">KOORDINÄ€TES</a>
							        <a href="https://cadet.mozello.lv/virtualais-kompass-macibu-materiali-un-instrukcija/macibu-materiali/citi/" class="dropdown-link">CITI</a>
									
									 
							 <iframe id="contentFrame" name="contentFrame" style="width: 100%; height: 75vh; border: none;"></iframe>
							        </div>
									 			
														
							</div>	
														

							 <!-- IzvÄ“lne konteineram -->
							 <!-- IzvÄ“lne konteineram LABAJÄ€ pusÄ“ -->
							<div class="position-selector-container">
								<div class="position-selector">
									<button class="toggle-selector">â¯</button>
									<select id="positionSelect">
										<option disabled selected>IzvÄ“lies pogas novietojumu:</option>
										<option value="bottom">ApakÅ¡Ä (noklusÄ“jums)</option>
										<option value="right">LabajÄ pusÄ“</option>
										<option value="left">KreisajÄ pusÄ“</option>
									</select>
								</div>
							</div>

							<!-- IzvÄ“lne konteineram KREISAJÄ€ pusÄ“ -->
							<div class="position-selector-container-left">
								<div class="position-selector-left">
									<button class="toggle-selector-left">â¯</button>
									<select id="positionSelectLeft">
										<option disabled selected>IzvÄ“lies pogas novietojumu:</option>
										<option value="bottom">ApakÅ¡Ä (noklusÄ“jums)</option>
										<option value="right">LabajÄ pusÄ“</option>
										<option value="left">KreisajÄ pusÄ“</option>
									</select>
								</div>
							</div>

							<!-- Popup grid view -->
							<div id="popupMenu" style="display: none;">
								<h3>IzvÄ“lieties noteikÅ¡anas metodi</h3>
								<div class="button-row">
									<button id="popupOption1" class="popup-button">
										<img src="https://site-710050.mozfiles.com/files/710050/GRID_VIEW_1_1.png" alt="Funkcija 1">
									</button>
									<button id="popupOption2" class="popup-button">
										<img src="https://site-710050.mozfiles.com/files/710050/GRID_VIEW_2.png" alt="Funkcija 2">
									</button>
								</div>
								<button id="popupClose" class="popup-close">AizvÄ“rt</button>
							</div>

							<!-- Pogas konteiners -->
							<div class="button-container bottom" id="buttonContainer">
								<button id="resetMap">
									<img src="https://site-710050.mozfiles.com/files/710050/RESER_MAPS_Cropped-Photoroom.png" alt="Reset Map">
								</button>
								<button id="uploadMap">
									<img src="https://site-710050.mozfiles.com/files/710050/UPLOAD_MAPS_Cropped-Photoroom.png" alt="Upload Map">
								</button>
								<button id="resetCompass">
									<img src="https://site-710050.mozfiles.com/files/710050/RESET_COMPASS_Cropped-Photoroom.png" alt="Reset Compass">
								</button>

								<button class="touch-only" id="toggleRotationMode">
									<img src="https://site-710050.mozfiles.com/files/710050/ROTATE_COMPASS_BASE__1__Cropped-Photoroom.png" alt="Toggle Rotation">
								</button>			
								<button class="touch-only" id="lockRotationMode">
									<img src="https://site-710050.mozfiles.com/files/710050/COMPASS_ROTATE_LOCK_OPEN__1__Cropped-Photoroom.png" alt="Lock Rotation">
								</button>	
								<button id="rotateCompass90">
									<img src="https://site-710050.mozfiles.com/files/710050/GRID_VIEW_Cropped-Photoroom.png" alt="Rotate 90Â° and Lock">
								</button>
								<button id="toggleFullscreen">
								<img id="fullscreenIcon" src="https://site-710050.mozfiles.com/files/710050/icon_fullscreen_enter.png" alt="PilnkrÄna IeslÄ“gÅ¡ana">
								</button>
							</div>
							
							<div id="about">
							<a href="javascript:void(0);" class="qrLink" onclick="toggleIframeQR(event)">KOPLIETOT</a>
								<span class="abouttext">CADET.LV</span>
								<span class="abouttext" >INTERAKTÄªVAIS KOMPASS</span> 
								<span class="abouttext">Â© JÄ€NIS EGLIS</span>
								<a href="javascript:void(0);" class="aboutlink" onclick="toggleIframeAbout(event)">ATSAUKSME / ZIÅ…OT</a>


							</div>
							
							
							<!-- IFRAME KONTEINERS (SÄ€KOTNÄ’JI PASLÄ’PTS) -->
							<div id="iframeContainerAbout">
								<iframe id="feedbackIframe" src="https://docs.google.com/forms/d/e/1FAIpQLSdflr72km2RpI7hdn05AmH5gRZgBk69y7UCz0sCJ37ujOyQ3Q/viewform?embedded=true" frameborder="0"></iframe>
								<button id="closeIframeAbout" onclick="toggleIframeAbout(event)">âœ–</button>
							</div>						
							
							
							
	


							<!-- QR kods konteineris (SÄ€KOTNÄ’JI PASLÄ’PTS) -->
							<div id="iframeContainerQR">
								<div id="qrCodeContent">
									<p class="qrTitle">KOPLIETOÅ ANAS QR KODS AUDITORIJAI</p>
									<img id="qrCodeImage" src="https://site-710050.mozfiles.com/files/710050/DOC_ERROR_AR_KRUSTU_PNG-1.png" alt="QR Code">
								</div>
								<button id="closeIframeQR" onclick="toggleIframeQR(event)">âœ–</button>
							</div>



							
							
							
							<div id="compassContainer">
								<div id="compassScaleContainer">
									<div id="compassInner">
										<img id="compassBase" src="https://site-710050.mozfiles.com/files/710050/VIRTUALAIS_KOMPASS_PAMATNE_PV6.png" alt="Compass Base">
									</div>  
									<div id="compassScaleInner">
										<img id="compassScale" src="https://site-710050.mozfiles.com/files/710050/KOMPASA_SKALA_CADET_LV_PV6_V3.png" alt="Compass Scale">
									</div>      
									<img id="compassNeedle" src="https://site-710050.mozfiles.com/files/710050/VIRTUALAIS_KOMPASS_ADATA_CADET_LV_PV4.png" alt="Compass Needle">  
								</div>
							</div>
						</body>
                    </html>
                `);
                interactiveWindow.document.close();

					// Dinamiska funkcionalitÄtes pievienoÅ¡ana
					const script = interactiveWindow.document.createElement('script');
					script.textContent = `


						function debounce(func, wait = 50) {
						  let timeout;
						  return function (...args) {
						    clearTimeout(timeout);
						    timeout = setTimeout(() => func.apply(this, args), wait);
						  };
						}
						
						// Izmanto vizuÄlo viewport (adreses joslas â€œelpoÅ¡anaâ€)
						function updateViewportHeight() {
						  const h = window.visualViewport ? window.visualViewport.height : window.innerHeight;
						  document.documentElement.style.setProperty('--vh', (h * 0.01) + 'px');
						}
						
						// ArÄ« loga izmÄ“ra pÄrbaude laiÅ¾ caur vizuÄlo viewport
						function checkWindowSize() {
						  const fullscreenMessage = document.getElementById('fullscreenMessage');
						  const w = window.innerWidth;
						  const h = window.visualViewport ? window.visualViewport.height : window.innerHeight;
						
						  if (w >= 1024 && h >= 700) {
						    fullscreenMessage.classList.add('hidden');
						  } else {
						    fullscreenMessage.classList.remove('hidden');
						  }
						}
						
						function handleResize() {
						  updateViewportHeight();
						  checkWindowSize();
						  // pÄrrÄ“Ä·ini doku uzreiz (lai nepÄrklÄjas ar #about)
						  window.__fitDock && window.__fitDock();
						}
						
						// SÄkotnÄ“jais un klasiskie notikumi
						window.addEventListener('load', handleResize);
						window.addEventListener('resize', debounce(handleResize, 50));
						window.addEventListener('orientationchange', handleResize);
						
						// Papildu notikumi, kas reaÄ£Ä“ uz adreses joslas parÄdÄ«Å¡anos/paslÄ“pÅ¡anos
						if (window.visualViewport) {
						  window.visualViewport.addEventListener('resize', debounce(handleResize, 50));
						  window.visualViewport.addEventListener('scroll', debounce(handleResize, 50));
						}


                        // DinamiskÄs pogas konfigurÄcija: katrai pogai sÄkuma un alternatÄ«vie attÄ“li
						const buttonImageMap = {
							"toggleRotationMode": {
								defaultSrc: "https://site-710050.mozfiles.com/files/710050/ROTATE_COMPASS_BASE__1__Cropped-Photoroom.png",
								alternateSrc: "https://site-710050.mozfiles.com/files/710050/SCALE_ROTATE__1__Cropped-Photoroom.png"
							},
							"lockRotationMode": {
								defaultSrc: "https://site-710050.mozfiles.com/files/710050/COMPASS_ROTATE_LOCK_OPEN__1__Cropped-Photoroom.png",
								alternateSrc: "https://site-710050.mozfiles.com/files/710050/COMPASS_ROTATE_LOCK__1__Cropped-Photoroom.png"
							}
						};



						// Funkcija, kas maina attÄ“lus uz pogÄm
						function toggleButtonImage(buttonId) {
							const button = document.getElementById(buttonId);
							const img = button.querySelector('img');
							const config = buttonImageMap[buttonId];

							if (img && config) {
								img.src = img.src === config.defaultSrc ? config.alternateSrc : config.defaultSrc;
							}
						}

						// Pievienojam notikumus pogÄm
						document.getElementById('toggleRotationMode').addEventListener('click', () => {
							toggleButtonImage('toggleRotationMode');
						});

						document.getElementById('lockRotationMode').addEventListener('click', () => {
							toggleButtonImage('lockRotationMode');
						});


						(function() {
							let previousTouchPoints = navigator.maxTouchPoints;

							/**
							 * Funkcija, kas pÄrbauda, vai ir pievienota vai atvienota skÄrienjÅ«tÄ«gÄ ierÄ«ce.
							 * ParÄda ziÅ†ojumu un aktivizÄ“ pogas ar klasi .touch-only.
							 */
							function checkTouchscreenStatus() {
								const currentTouchPoints = navigator.maxTouchPoints;
								const touchscreenPopup = document.getElementById('touchscreenPopup');
								
								if (currentTouchPoints > previousTouchPoints) {
									console.log('ğŸŸ¢ Pievienota ÄrÄ“jÄ skÄrienjÅ«tÄ«gÄ ierÄ«ce. AktivizÄ“tas papildu pogas!');
									showPopupMessage('Pievienota ÄrÄ“jÄ skÄrienjÅ«tÄ«gÄ ierÄ«ce. AktivizÄ“tas papildu pogas!', 'popup-success');
									showTouchOnlyButtons();
								} else if (currentTouchPoints < previousTouchPoints) {
									console.log('ğŸ”´ Atvienota ÄrÄ“jÄ skÄrienjÅ«tÄ«gÄ ierÄ«ce. Papildu pogas paslÄ“ptas!');
									showPopupMessage('Atvienota ÄrÄ“jÄ skÄrienjÅ«tÄ«gÄ ierÄ«ce. Papildu pogas paslÄ“ptas!', 'popup-error');
									hideTouchOnlyButtons();
								}

								previousTouchPoints = currentTouchPoints;
							}

							/**
							 * Funkcija, kas parÄda uznirstoÅ¡o paziÅ†ojumu.
							 * @param {string} message - ZiÅ†ojuma teksts.
							 * @param {string} popupClass - Papildu klases nosaukums ('popup-success' vai 'popup-error').
							 */
							function showPopupMessage(message, popupClass) {
								const popup = document.getElementById('touchscreenPopup');
								popup.textContent = message;
								popup.classList.remove('popup-success', 'popup-error');
								popup.classList.add(popupClass);
								popup.style.display = 'block';

								setTimeout(() => {
									popup.style.display = 'none';
								}, 5000); // ParÄda ziÅ†ojumu 5 sekundes
							}

							/**
function showTouchOnlyButtons() {
  const touchOnlyElements = document.querySelectorAll('.touch-only');
  touchOnlyElements.forEach(el => {
    el.classList.add('touch-visible');
    el.style.display = 'inline-block';
  });

  // pÄrrÄ“Ä·ina slÄ«dÅ†a â€œspanâ€ pÄ“c pogu skaita
  window.__updateDimmerWidth && window.__updateDimmerWidth();
  // (neobligÄti) pielÄgo arÄ« doka mÄ“rogu
  window.__fitDock && window.__fitDock();

  console.log('âœ… SkÄrienjÅ«tÄ«gÄs pogas ir redzamas.');
}

function hideTouchOnlyButtons() {
  const touchOnlyElements = document.querySelectorAll('.touch-only');
  touchOnlyElements.forEach(el => {
    el.classList.remove('touch-visible');
    el.style.display = 'none';
  });

  // pÄrrÄ“Ä·ina slÄ«dÅ†a â€œspanâ€ pÄ“c pogu skaita
  window.__updateDimmerWidth && window.__updateDimmerWidth();
  // (neobligÄti) pielÄgo arÄ« doka mÄ“rogu
  window.__fitDock && window.__fitDock();

  console.log('âŒ SkÄrienjÅ«tÄ«gÄs pogas ir paslÄ“ptas.');
}


							/**
							 * Funkcija, kas uzsÄk pÄrbaudi ik pÄ“c 1 sekundes, vai ir pievienota skÄrienjÅ«tÄ«ga ierÄ«ce.
							 */
							function startContinuousCheck() {
								setInterval(checkTouchscreenStatus, 1000); // PÄrbauda ik pÄ“c 1 sekundes
							}

							/**
							 * Funkcija, kas tiek izsaukta, kad pievieno jaunas USB vai citas ÄrÄ“jÄs ierÄ«ces.
							 */
							function listenForDeviceChanges() {
								if (navigator.mediaDevices && navigator.mediaDevices.addEventListener) {
									navigator.mediaDevices.addEventListener('devicechange', () => {
										console.log('ğŸ”„ KonstatÄ“tas ierÄ«Äu izmaiÅ†as.');
										checkTouchscreenStatus();
									});
								}
							}

							/**
							 * SÄkotnÄ“jais process, kas tiek izsaukts, kad logs ir ielÄdÄ“ts.
							 */
							window.addEventListener('load', () => {
								checkTouchscreenStatus(); // PÄrbauda statusu, kad lapa tiek ielÄdÄ“ta
								startContinuousCheck(); // SÄk nepÄrtrauktu pÄrbaudi ik pÄ“c 1 sekundes
								listenForDeviceChanges(); // SÄk klausÄ«ties, kad pievieno vai atvieno ierÄ«ces
							});

							/**
							 * Notikuma klausÄ«tÄjs pointerdown notikumam.
							 * Ja konstatÄ“ts pieskÄriens, parÄda touch-only pogas.
							 */
							window.addEventListener('pointerdown', (event) => {
								if (event.pointerType === 'touch') {
									console.log('ğŸŸ¢ PieskÄriens atklÄts.');
									showTouchOnlyButtons();
								}
							});
						})();



						// Funkcija, kas pÄrbauda ierÄ«ces orientÄciju
						function checkOrientation() {
							const overlay = document.getElementById('orientation-overlay');

							if (window.matchMedia("(orientation: portrait)").matches) {
								// Ja ierÄ«ce ir vertikÄlÄ reÅ¾Ä«mÄ
								overlay.style.display = 'flex';
							} else {
								// Ja ierÄ«ce ir horizontÄlÄ reÅ¾Ä«mÄ
								overlay.style.display = 'none';
							}
						}


						// Funkcija pÄrbauda, vai tiek izmantots viedtÄlrunis ar mazu ekrÄnu
						function showMobileWarning() {
							const warningElement = document.getElementById('mobile-warning');

							// ViedtÄlruÅ†a detekcija (User Agent + ekrÄna platuma pÄrbaude)
							const isMobileDevice = /iphone|ipod|android.*mobile|windows phone|iemobile|opera mini/.test(navigator.userAgent.toLowerCase());
							const isSmallScreen = window.innerWidth < 900; // EkrÄna platums < 768px

							if (isMobileDevice && isSmallScreen) {
								warningElement.style.display = 'flex'; // ParÄda brÄ«dinÄjumu
							} else {
								warningElement.style.display = 'none'; // SlÄ“pj brÄ«dinÄjumu
							}
						}

						// Notikumu klausÄ«tÄji
						window.addEventListener('load', showMobileWarning);
						window.addEventListener('resize', showMobileWarning);

						// Izsaucam funkciju sÄkumÄ un pie orientÄcijas izmaiÅ†Äm
						checkOrientation();
						window.addEventListener('resize', checkOrientation);
						window.addEventListener('orientationchange', checkOrientation);

						// Funkcija, kas aizver abas izvÄ“lnes
						function closeBothMenus() {
							const leftPositionSelector = document.querySelector('.position-selector-left');
							const rightPositionSelector = document.querySelector('.position-selector');

							// Pievieno slÄ“pÅ¡anas klases abÄm izvÄ“lnÄ“m
							leftPositionSelector.classList.add('hidden-left');
							rightPositionSelector.classList.add('hidden');
							
							// Atjauno bultiÅ†u simbolus
							const leftToggleButton = document.querySelector('.toggle-selector-left');
							const rightToggleButton = document.querySelector('.toggle-selector');
							leftToggleButton.textContent = 'â¯';
							rightToggleButton.textContent = 'â®';
						}

						// LabÄs puses pogas klausÄ«tÄjs
						const toggleButton = document.querySelector('.toggle-selector');
						const positionSelector = document.querySelector('.position-selector');
						toggleButton.addEventListener('click', () => {
							if (positionSelector.classList.contains('hidden')) {
								positionSelector.classList.remove('hidden');
								toggleButton.textContent = 'â¯'; // BultiÅ†a norÄda uz aizvÄ“rÅ¡anu
							} else {
								closeBothMenus(); // Aizver abas izvÄ“lnes
							}
						});

						// KreisÄs puses pogas klausÄ«tÄjs
						const leftToggleButton = document.querySelector('.toggle-selector-left');
						const leftPositionSelector = document.querySelector('.position-selector-left');
						leftToggleButton.addEventListener('click', () => {
							if (leftPositionSelector.classList.contains('hidden-left')) {
								leftPositionSelector.classList.remove('hidden-left');
								leftToggleButton.textContent = 'â®'; // BultiÅ†a norÄda uz aizvÄ“rÅ¡anu
							} else {
								closeBothMenus(); // Aizver abas izvÄ“lnes
							}
						});


						// Funkcija, kas sinhronizÄ“ izvÄ“les abÄs izvÄ“lnÄ“s
						function syncSelectOptions(selectedValue) {
							const leftSelectElement = document.getElementById('positionSelectLeft');
							const rightSelectElement = document.getElementById('positionSelect');
							leftSelectElement.value = selectedValue;
							rightSelectElement.value = selectedValue;
						}

						// KlausÄ«tÄjs kreisÄs puses izvÄ“lei, kas sinhronizÄ“ izvÄ“li un aizver abas izvÄ“lnes
						const leftSelectElement = document.getElementById('positionSelectLeft');
						leftSelectElement.addEventListener('change', () => {
							const selectedValue = leftSelectElement.value;
							syncSelectOptions(selectedValue); // SinhronizÄ“ izvÄ“li abÄs izvÄ“lnÄ“s
							closeBothMenus(); // Aizver abas izvÄ“lnes
							updateButtonContainerPosition(selectedValue); // Atjaunina pogu novietojumu
						});

						// KlausÄ«tÄjs labÄs puses izvÄ“lei, kas sinhronizÄ“ izvÄ“li un aizver abas izvÄ“lnes
						const rightSelectElement = document.getElementById('positionSelect');
						rightSelectElement.addEventListener('change', () => {
							const selectedValue = rightSelectElement.value;
							syncSelectOptions(selectedValue); // SinhronizÄ“ izvÄ“li abÄs izvÄ“lnÄ“s
							closeBothMenus(); // Aizver abas izvÄ“lnes
							updateButtonContainerPosition(selectedValue); // Atjaunina pogu novietojumu
						});


						const savedPosition = localStorage.getItem('buttonPosition');
						const valid = ['bottom', 'left', 'right'];
						const initial = valid.includes(savedPosition) ? savedPosition : 'bottom';
						
						syncSelectOptions(initial);
						updateButtonContainerPosition(initial);


						// Funkcija, kas atjaunina pogas konteinera novietojumu atkarÄ«bÄ no izvÄ“lÄ“tÄs vÄ“rtÄ«bas
function updateButtonContainerPosition(position){
  const buttonContainer = document.getElementById('buttonContainer');
  buttonContainer.classList.remove('bottom','right','left');
  buttonContainer.classList.add(position);

  localStorage.setItem('buttonPosition', position);

  window.__fitDock && window.__fitDock();
  window.__updateDimmerWidth && window.__updateDimmerWidth(); // â† paliek
}



						document.addEventListener('DOMContentLoaded', () => {
							// AtlasÄm kreisÄs puses pogu
							const leftToggleButton = document.querySelector('.toggle-selector-left');
							const leftPositionSelector = document.querySelector('.position-selector-left');

						// PÄrbaudÄm, vai izvÄ“lne ir redzama vai paslÄ“pta, un iestatÄm bultiÅ†as virzienu
						if (leftPositionSelector.classList.contains('hidden-left')) {
								leftToggleButton.textContent = 'â¯'; // IzvÄ“lne ir paslÄ“pta, bultiÅ†a uz priekÅ¡u
							} else {
								leftToggleButton.textContent = 'â®'; // IzvÄ“lne ir redzama, bultiÅ†a uz iekÅ¡u
							}
						
						if (!leftPositionSelector.classList.contains('hidden-left')) {
							leftPositionSelector.classList.add('hidden-left'); 
							}
						});

						



						const canvas = document.getElementById('mapCanvas');
						const ctx = canvas.getContext('2d');
						const img = new Image();
						img.src = ''; // Tiks pievienots pÄ“c augÅ¡upielÄdes

						let imgX = 0, imgY = 0;
						let imgScale = 1;
						let imgWidth, imgHeight;
						let dragging = false;
						let resizing = false;
						let startX, startY;
						let startWidth, startHeight;
						let lastTouchDistance = 0;
						const initialScale = 0.9;

// TumÅ¡oÅ¡anas intensitÄte (0..0.8), glabÄjam % localStorage (0..80)
let mapDarken = (+(localStorage.getItem('mapDarken') || 0)) / 100;




						const resizeHandle = document.getElementById('resizeHandle');
						resizeHandle.style.display = 'block';
						resizeHandle.style.position = 'absolute'; // NodroÅ¡ina, ka rokturis tiek pozicionÄ“ts attiecÄ«bÄ pret attÄ“lu, nevis fiksÄ“ti uz ekrÄna.
						resizeHandle.style.zIndex = '10';
						resizeHandle.style.width = Math.max(40, window.innerWidth * 0.05) + 'px';
						resizeHandle.style.height = Math.max(40, window.innerHeight * 0.05) + 'px';
						resizeHandle.style.backgroundImage = 'url("https://site-710050.mozfiles.com/files/710050/resize_map__1_.png")';

						resizeHandle.style.cursor = 'se-resize';
						resizeHandle.style.border = '3px red';


						img.onload = function () {
							adjustImageSize();
							drawImage();
							positionResizeHandle();
							resizeHandle.style.display = 'block';
						};

						function adjustImageSize() {
						const aspectRatio = img.naturalWidth / img.naturalHeight;
						const scaleFactor = 0.85; // ğŸ“Œ PielÄgojam attÄ“lu uz 90% no sÄkotnÄ“jÄ izmÄ“ra

						if (canvas.width / canvas.height > aspectRatio) {
							imgWidth = canvas.height * aspectRatio * scaleFactor;
							imgHeight = canvas.height * scaleFactor;
						} else {
							imgWidth = canvas.width * scaleFactor;
							imgHeight = (canvas.width / aspectRatio) * scaleFactor;
						}

						// âœ… CentrÄ“jam attÄ“lu kanvÄ
						imgX = (canvas.width - imgWidth) / 2;
						imgY = (canvas.height - imgHeight) / 2;

						imgScale = 1; // ğŸ“Œ NodroÅ¡ina sÄkotnÄ“jo mÄ“rogu (bez tÄlummaiÅ†as)
						}
	

						function drawImage() {
							ctx.clearRect(0, 0, canvas.width, canvas.height);
							ctx.drawImage(img, imgX, imgY, imgWidth * imgScale, imgHeight * imgScale);
							positionResizeHandle();
						}

						// Reset Map Button Functionality
						document.getElementById('resetMap').addEventListener('click', () => {
							adjustImageSize();
							drawImage();
						});

						// AttÄ“la pÄrvietoÅ¡ana
						canvas.addEventListener('mousedown', (e) => {
							if (e.target === resizeHandle) return;
							startX = e.offsetX;
							startY = e.offsetY;
							dragging = true;
						});

						canvas.addEventListener('mousemove', (e) => {
							if (dragging) {
								let dx = e.offsetX - startX;
								let dy = e.offsetY - startY;
								imgX += dx;
								imgY += dy;
								startX = e.offsetX;
								startY = e.offsetY;
								drawImage();
							}
						});

						canvas.addEventListener('mouseup', () => {
							dragging = false;
						});

						// PrecÄ«zÄka tÄlummaiÅ†a ar peles riteni
						canvas.addEventListener('wheel', (e) => {
							e.preventDefault();
							const zoomFactor = e.deltaY > 0 ? 0.95 : 1.05;
							const mouseX = e.offsetX;
							const mouseY = e.offsetY;

							// AprÄ“Ä·ina attÄlumu no kursora lÄ«dz attÄ“la pozÄ«cijai
							const offsetX = mouseX - imgX;
							const offsetY = mouseY - imgY;

							// AprÄ“Ä·ina jauno attÄ“la pozÄ«ciju pÄ“c tÄlummaiÅ†as
							imgX = mouseX - offsetX * zoomFactor;
							imgY = mouseY - offsetY * zoomFactor;

							imgScale *= zoomFactor;
							drawImage();
						});


						// SkÄrienjÅ«tÄ«bas atbalsts (pÄrvietoÅ¡ana, tÄlummaiÅ†a un izmÄ“ru maiÅ†a)
						canvas.addEventListener('touchstart', (e) => {
							e.preventDefault();
							if (e.touches.length === 1) { // PÄrvietoÅ¡ana
								startX = e.touches[0].clientX;
								startY = e.touches[0].clientY;
								dragging = true;
							} else if (e.touches.length === 2) { // TÄlummaiÅ†a
								lastTouchDistance = getDistance(e.touches[0], e.touches[1]);
							}
						});



						canvas.addEventListener('touchstart', (e) => {
							e.preventDefault();
							if (e.touches.length === 1) { // PÄrvietoÅ¡ana
								startX = e.touches[0].clientX;
								startY = e.touches[0].clientY;
								dragging = true;
							} else if (e.touches.length === 2) { // TÄlummaiÅ†a
								lastTouchDistance = getDistance(e.touches[0], e.touches[1]);
							}
						});

						canvas.addEventListener('touchmove', (e) => {
							e.preventDefault();
							if (e.touches.length === 1 && dragging) { // PÄrvietoÅ¡ana
								let dx = e.touches[0].clientX - startX;
								let dy = e.touches[0].clientY - startY;
								imgX += dx;
								imgY += dy;
								startX = e.touches[0].clientX;
								startY = e.touches[0].clientY;
								drawImage();
							} else if (e.touches.length === 2) { // TÄlummaiÅ†a
								const touch1 = e.touches[0];
								const touch2 = e.touches[1];
								const newDistance = getDistance(touch1, touch2);
								let zoomFactor = newDistance / lastTouchDistance;
								lastTouchDistance = newDistance;
								
								// AprÄ“Ä·ina pieskÄrienu centru
								const centerX = (touch1.clientX + touch2.clientX) / 2;
								const centerY = (touch1.clientY + touch2.clientY) / 2;
								
								// PielÄgo attÄ“la pozÄ«ciju, lai tÄlummaiÅ†a notiktu vietÄ, kur lietotÄjs pietuvina
								imgX = centerX - (centerX - imgX) * zoomFactor;
								imgY = centerY - (centerY - imgY) * zoomFactor;
								
								imgScale *= zoomFactor;
								drawImage();
							}
						});

						canvas.addEventListener('touchend', () => {
							dragging = false;
						});

						function getDistance(touch1, touch2) {
							const dx = touch1.clientX - touch2.clientX;
							const dy = touch1.clientY - touch2.clientY;
							return Math.sqrt(dx * dx + dy * dy);
						}



						canvas.addEventListener('touchend', () => {
							dragging = false;
						});

						function getDistance(touch1, touch2) {
							const dx = touch1.clientX - touch2.clientX;
							const dy = touch1.clientY - touch2.clientY;
							return Math.sqrt(dx * dx + dy * dy);
						}

						// IzmÄ“ra maiÅ†a ar rokturi un skÄrienjÅ«tÄ«bu
						resizeHandle.addEventListener('mousedown', startResize);
						resizeHandle.addEventListener('touchstart', startResize);

						function startResize(e) {
							e.preventDefault();
							resizing = true;
							startX = e.clientX || e.touches[0].clientX;
							startY = e.clientY || e.touches[0].clientY;
							startWidth = imgWidth;
							startHeight = imgHeight;
							document.addEventListener('mousemove', resizeImage);
							document.addEventListener('mouseup', stopResize);
							document.addEventListener('touchmove', resizeImage);
							document.addEventListener('touchend', stopResize);
						}

						function resizeImage(e) {
							if (resizing) {
								let dx = (e.clientX || e.touches[0].clientX) - startX;
								let dy = (e.clientY || e.touches[0].clientY) - startY;
								imgWidth = Math.max(50, startWidth + dx);
								imgHeight = Math.max(50, startHeight + dy);
								drawImage();
							}
						}

						function stopResize() {
							resizing = false;
							document.removeEventListener('mousemove', resizeImage);
							document.removeEventListener('mouseup', stopResize);
							document.removeEventListener('touchmove', resizeImage);
							document.removeEventListener('touchend', stopResize);
						}

						// Piesaiste rokturim pie attÄ“la
						function positionResizeHandle() {
							if (window.innerWidth <= 768) { // Mobile adjustments
								resizeHandle.style.left = (imgX + (imgWidth * imgScale) - resizeHandle.clientWidth - 5) + 'px';
							} else { // Desktop adjustments
								resizeHandle.style.left = (imgX + (imgWidth * imgScale) - resizeHandle.clientWidth) + 'px';
							}
							if (window.innerWidth <= 768) { // Mobile adjustments
								resizeHandle.style.top = (imgY + (imgHeight * imgScale) - resizeHandle.clientHeight - 5) + 'px';
							} else { // Desktop adjustments
								resizeHandle.style.top = (imgY + (imgHeight * imgScale) - resizeHandle.clientHeight) + 'px';
							}
							resizeHandle.style.display = 'flex';
						}


						// AttÄ“la augÅ¡upielÄde
						const uploadBtn = document.getElementById('uploadMap');
						if (uploadBtn) {
							uploadBtn.addEventListener('click', () => {
								const fileInput = document.createElement('input');
								fileInput.type = 'file';
								fileInput.accept = 'image/*';
								fileInput.addEventListener('change', (event) => {
									const file = event.target.files[0];
									if (file) {
										const reader = new FileReader();
										reader.onload = (e) => {
											img.src = e.target.result; // IelÄdÄ“ attÄ“lu
										};
										reader.readAsDataURL(file);
									}
								});
								fileInput.click();
							});
						}




						// Kad attÄ“ls ir ielÄdÄ“ts, pievieno apmali, bet saglabÄ funkcionalitÄti
						img.onload = function () {
							adjustImageSize(); // NodroÅ¡ina sÄkotnÄ“jo attÄ“la novietojumu
							drawImage(); // UzzÄ«mÄ“ attÄ“lu
							

						// PIEVIENO APMALI UZ CANVAS
						ctx.lineWidth = 2; // Apmales biezums
						ctx.strokeStyle = "red"; // Apmales krÄsa
						ctx.strokeRect(imgX, imgY, imgWidth * imgScale, imgHeight * imgScale); // Apvelk attÄ“lu

						positionResizeHandle(); // NodroÅ¡ina, ka izmÄ“ru maiÅ†as punkts ir pareizÄ vietÄ
						resizeHandle.style.display = 'block';
						};




function drawImage() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // 1) Karte
  ctx.drawImage(img, imgX, imgY, imgWidth * imgScale, imgHeight * imgScale);

  // 2) TumÅ¡oÅ¡anas pÄrklÄjums tikai kartes laukumam
  if (mapDarken > 0) {
    ctx.save();
    ctx.fillStyle = 'rgba(0,0,0,' + mapDarken + ')'; // 0..0.8
    ctx.fillRect(imgX, imgY, imgWidth * imgScale, imgHeight * imgScale);
    ctx.restore();
  }

  // 3) Sarkanais rÄmis virs pÄrklÄjuma
  ctx.lineWidth = 2;
  ctx.strokeStyle = "red";
  ctx.strokeRect(imgX, imgY, imgWidth * imgScale, imgHeight * imgScale);

  // 4) Roktura pozÄ«cija
  positionResizeHandle();
}




						function isMobileDevice() {
							const userAgent = navigator.userAgent.toLowerCase();
							const isMobileUserAgent = /iphone|ipad|ipod|android|blackberry|bb10|opera mini|iemobile|windows phone|mobile|tablet/.test(userAgent);
							const isSmallScreen = window.innerWidth < 1024; 
							const isHighDPR = window.devicePixelRatio > 1.5;

							return isMobileUserAgent || (isSmallScreen && isHighDPR);
						}

						function showMessageForDesktopOnly() {
							const fullscreenMessage = document.getElementById('fullscreenMessage');

							if (!isMobileDevice()) {
								fullscreenMessage.classList.remove('fs-message-hidden');
							} else {
								fullscreenMessage.classList.add('fs-message-hidden');
							}
						}

						window.addEventListener('load', showMessageForDesktopOnly);
						window.addEventListener('resize', showMessageForDesktopOnly);


						// SÄkotnÄ“jais izsaukums
						handleResize();


						checkWindowSize();
						window.addEventListener('resize', checkWindowSize);
						
		
						// Pievienojam compassContainer funkcijas pÄ“c tam, kad ir definÄ“ts canvas, mapImage utt.

						// AtlasÄm compassContainer elementu
							const compassContainer = document.getElementById('compassContainer');
							const compassInner = document.getElementById('compassInner');
							const compassScaleContainer = document.getElementById('compassScaleContainer');
							const compassScaleInner = document.getElementById('compassScaleInner');
							const compassNeedle = document.getElementById('compassNeedle');
							const toggleRotationModeButton = document.getElementById('toggleRotationMode');
							const lockRotationModeButton = document.getElementById('lockRotationMode');
							const resetCompassButton = document.getElementById('resetCompass');
							// SÄkotnÄ“jÄs vÄ“rtÄ«bas, lai atjaunotu kompasu
							const initialCompassLeft = 550; // SÄkotnÄ“jÄ X pozÄ«cija
							const initialCompassTop = 60; // SÄkotnÄ“jÄ Y pozÄ«cija
							const initialGlobalScale = 1; // SÄkotnÄ“jais mÄ“rogs
							const initialBaseRotation = 0; // SÄkotnÄ“jÄ bÄzes rotÄcija
							const initialScaleRotation = 70; // SÄkotnÄ“jÄ skalas rotÄcija


						// SÄkotnÄ“jie mainÄ«gie priekÅ¡ pÄrvietoÅ¡anas, rotÄcijas, mÄ“roga
							let compassIsDragging = false;
							let compassDragStartX = 0;
							let compassDragStartY = 0;
							let compassStartLeft = 0;   // SÄkotnÄ“jÄs pozÄ«cijas - var mainÄ«t pÄ“c vajadzÄ«bas
							let compassStartTop = 0;    // SÄkotnÄ“jÄs pozÄ«cijas
							let activeRotationTarget = 'compassInner'; //  KontrolÄ“jam, vai rotÄ“jam bÄzi vai skalu
							let isTouchingCompass = false; // Lai sekotu lÄ«dzi, vai skar kompasu
							let touchStartX = 0; // Pirmais pieskÄriena punkts X koordinÄ
							let touchStartY = 0; // Pirmais pieskÄriena punkts Y koordinÄ
							let isRotationLocked = false; // Vai rotÄcija ir bloÄ·Ä“ta

						// Jaunie mainÄ«gie atseviÅ¡Ä·Äm transformÄcijÄm
							let globalScale = 1;      // mÄ“rogs visam kompasam (compassScaleContainer)
							let baseRotation = 0;     // rotÄcija bÄzei (compassInner)
							let scaleRotation = 70;    // rotÄcija skalai (compassScaleInner)

						// Helper funkcijas
						function getDistance(touch1, touch2) {
						  const dx = touch2.clientX - touch1.clientX;
						  const dy = touch2.clientY - touch1.clientY;
						  return Math.sqrt(dx * dx + dy * dy);
						}

						function getAngle(touch1, touch2) {
						  const dx = touch2.clientX - touch1.clientX;
						  const dy = touch2.clientY - touch1.clientY;
						  return Math.atan2(dy, dx) * (180 / Math.PI);
						}


						// === FUNKCIJA POGAS NÅªKOÅ ANAI (tikai skÄrienierÄ«cÄ“s) ===



						toggleRotationModeButton.addEventListener('click', () => {
							activeRotationTarget = activeRotationTarget === 'compassInner' ? 'compassScaleInner' : 'compassInner';
							
							// MainÄm pogas fona krÄsu, lai parÄdÄ«tu, kas paÅ¡laik tiek rotÄ“ts
							toggleRotationModeButton.style.backgroundColor = activeRotationTarget === 'compassInner' ? 'rgba(91, 16, 16, 0.8)' : 'rgb(187, 1, 1)';
						});



						// Notikumu klausÄ«tÄjs pogai, kas bloÄ·Ä“ rotÄciju
						if (lockRotationModeButton) {
							lockRotationModeButton.addEventListener('click', () => {
								isRotationLocked = !isRotationLocked; // MainÄm bloÄ·Ä“Å¡anas statusu
								lockRotationModeButton.classList.toggle('active', isRotationLocked); // Pievienojam vai noÅ†emam aktÄ«vo klasi
							});
						}

						// PÄrbaudÄm, vai poga eksistÄ“
						if (resetCompassButton) {
							// Pievienojam klikÅ¡Ä·a notikumu
							resetCompassButton.addEventListener('click', () => {
								
								// Pievienojam CSS klasi, kas aktivizÄ“ pÄreju
								
								compassContainer.classList.add('with-transition');
								compassInner.classList.add('with-transition');
								compassScaleInner.classList.add('with-transition');
								compassScaleContainer.classList.add('with-transition'); // JaunÄ daÄ¼a
								
								// Atjaunojam sÄkotnÄ“jos mainÄ«gos
								compassStartLeft = 550; // sÄkotnÄ“jÄ pozÄ«cija pa kreisi
								compassStartTop = 60;   // sÄkotnÄ“jÄ pozÄ«cija pa augÅ¡u
								globalScale = 1;        // sÄkotnÄ“jais mÄ“rogs
								baseRotation = 0;       // sÄkotnÄ“jÄ rotÄcija
								scaleRotation = 70;      // sÄkotnÄ“jÄ skalas rotÄcija

								// Atjaunojam kompasu (tiek pÄrvietots atpakaÄ¼ sÄkuma stÄvoklÄ«)
								updateCompassTransform();

								// NoÅ†emam klasi pÄ“c 0.5 sekundÄ“m (pÄ“c pÄrejas beigÄm)
								setTimeout(() => {
								 
									compassContainer.classList.remove('with-transition');
									compassInner.classList.remove('with-transition');
									compassScaleInner.classList.remove('with-transition');
									compassScaleContainer.classList.remove('with-transition');
								}, 500); // PÄrejas ilgums (0.5s)
							});
						}


						// Atjauno transformÄcijas
						function updateCompassTransform() {
							compassContainer.style.left = compassStartLeft + 'px';
							compassContainer.style.top = compassStartTop + 'px';

							// MÄ“rogoÅ¡ana visam kompasam
							compassScaleContainer.style.transform = 'scale(' + globalScale + ')';

							// BÄzes rotÄcija
							compassInner.style.transform = 'rotate(' + baseRotation + 'deg)';

							// SkalÄs rotÄcija
							compassScaleInner.style.transform = 'rotate(' + scaleRotation + 'deg)';
						}


						// NodroÅ¡inÄm, lai stili tiek piemÄ“roti
							updateCompassTransform();



						const rotateCompass90Button = document.getElementById('rotateCompass90');
						let isCompassLocked = false; // Lai sekotu, vai kompass ir bloÄ·Ä“ts

						if (rotateCompass90Button) {
							rotateCompass90Button.addEventListener('click', function () {
								if (!isCompassLocked) {
									// Izveido popup izvÄ“lni
									const popupMenu = document.createElement('div');
									popupMenu.id = 'popupMenu';

									// Izveido popup saturu
									const menuTitle = document.createElement('p');
									menuTitle.textContent = 'IzvÄ“lieties noteikÅ¡anas metodi:';
									popupMenu.appendChild(menuTitle);

									// Izveido pogu rindu
									const buttonRow = document.createElement('div');
									buttonRow.className = 'button-row';

									// 1. poga ar jauno attÄ“lu
									const rotate90Button = document.createElement('button');
									rotate90Button.id = 'rotateTo90';
									rotate90Button.className = 'popup-button';
									const rotate90Image = document.createElement('img');
									rotate90Image.src = 'https://site-710050.mozfiles.com/files/710050/GRID_VIEW_1_1.png';
									rotate90Image.alt = 'RotÄ“t 90Â°';
									rotate90Button.appendChild(rotate90Image);
									buttonRow.appendChild(rotate90Button);

									// 2. poga ar jauno attÄ“lu
									const rotateNegative90Button = document.createElement('button');
									rotateNegative90Button.id = 'rotateToNegative90';
									rotateNegative90Button.className = 'popup-button';
									const rotateNegative90Image = document.createElement('img');
									rotateNegative90Image.src = 'https://site-710050.mozfiles.com/files/710050/GRID_VIEW_2.png';
									rotateNegative90Image.alt = 'RotÄ“t -90Â°';
									rotateNegative90Button.appendChild(rotateNegative90Image);
									buttonRow.appendChild(rotateNegative90Button);

									popupMenu.appendChild(buttonRow);
									document.body.appendChild(popupMenu);

									rotate90Button.addEventListener('click', () => {
										compassInner.classList.add('with-transition'); 
										compassScaleInner.classList.add('with-transition');

										baseRotation = 90; 
										updateCompassTransform(); 

										isRotationLocked = true; 
										lockRotationModeButton.classList.add('active'); 
										rotateCompass90Button.classList.add('active'); 
										isCompassLocked = true;

										setTimeout(() => {
											compassInner.classList.remove('with-transition');
											compassScaleInner.classList.remove('with-transition');
										}, 500);

										document.body.removeChild(popupMenu); 
									});

									rotateNegative90Button.addEventListener('click', () => {
										compassInner.classList.add('with-transition'); 
										compassScaleInner.classList.add('with-transition'); 

										baseRotation = -90; 
										updateCompassTransform(); 

										isRotationLocked = true; 
										lockRotationModeButton.classList.add('active'); 
										rotateCompass90Button.classList.add('active'); 
										isCompassLocked = true;

										setTimeout(() => {
											compassInner.classList.remove('with-transition');
											compassScaleInner.classList.remove('with-transition');
										}, 500);

										document.body.removeChild(popupMenu); 
									});
								} else {
									isRotationLocked = false; 
									lockRotationModeButton.classList.remove('active'); 
									rotateCompass90Button.classList.remove('active'); 
									isCompassLocked = false;
								}
							});
						}

						// Event listeneri pÄrvietoÅ¡anai
							compassContainer.addEventListener('mousedown', (e) => {
							  e.preventDefault(); // NeÄ¼auj pÄrlÅ«kam mÄ“Ä£inÄt vilkt attÄ“lu
							  compassIsDragging = true;
							  const rect = compassContainer.getBoundingClientRect();
							  compassDragStartX = e.clientX - rect.left;
							  compassDragStartY = e.clientY - rect.top;
							  e.stopPropagation();
							});


							// SkÄrienu apstrÄde (drag, pinch zoom, rotate)
							compassContainer.addEventListener('touchstart', (e) => {
								e.preventDefault();
								if (e.touches.length === 1) { 
									isTouchingCompass = true;
									touchStartX = e.touches[0].clientX;
									touchStartY = e.touches[0].clientY;

									// AktivizÄ“jam velkÅ¡anas funkcionalitÄti
									compassDragStartX = e.touches[0].clientX - compassStartLeft;
									compassDragStartY = e.touches[0].clientY - compassStartTop;
								} else if (e.touches.length === 2) { 
									lastTouchDistance = getDistance(e.touches[0], e.touches[1]);
									lastRotation = getAngle(e.touches[0], e.touches[1]);
								}
							});

							document.addEventListener('mousemove', (e) => {
							  if (compassIsDragging) {
								compassStartLeft = e.clientX - compassDragStartX;
								compassStartTop = e.clientY - compassDragStartY;
								updateCompassTransform();
							  }
							});

							document.addEventListener('mouseup', () => {
							  compassIsDragging = false;
							});


							// SkÄrienkustÄ«bu apstrÄde (drag, pinch zoom, rotate)
							compassContainer.addEventListener('touchmove', (e) => {
								e.preventDefault();
								if (e.touches.length === 1 && isTouchingCompass) { // Dragging
									const dx = e.touches[0].clientX - touchStartX;
									const dy = e.touches[0].clientY - touchStartY;

									compassStartLeft = e.touches[0].clientX - compassDragStartX;
									compassStartTop = e.touches[0].clientY - compassDragStartY;
									
									updateCompassTransform();
								} 
								else if (e.touches.length === 2) { // Pinch zoom and rotate
								const newDistance = getDistance(e.touches[0], e.touches[1]);
								globalScale *= newDistance / lastTouchDistance;
								lastTouchDistance = newDistance;

								if (!isRotationLocked) { // PÄrbaudÄm, vai rotÄcija ir bloÄ·Ä“ta
									const newRotation = getAngle(e.touches[0], e.touches[1]);
									if (activeRotationTarget === 'compassInner') {
										baseRotation += newRotation - lastRotation;
									} else if (activeRotationTarget === 'compassScaleInner') {
										scaleRotation += newRotation - lastRotation;
									}
									lastRotation = newRotation;
								}

								updateCompassTransform();
							}

							});


							compassContainer.addEventListener('touchend', () => {
								isTouchingCompass = false;
							});


							// MÄ“rogÅ¡ana un rotÄcija - izmanto peles ritenÄ«ti virs compassContainer
								compassContainer.addEventListener('wheel', (e) => {
								  e.preventDefault();
								  // SHIFT + wheel -> bÄzes rotÄcija
								  // ALT + wheel -> mÄ“rogs
								  // CTRL + wheel -> skalas rotÄcija (piemÄ“ram, ja vajag atseviÅ¡Ä·i kontrolÄ“t skalu)
								  if (e.shiftKey) {
									// RotÄ“jam bÄzi
									baseRotation += e.deltaY * 0.005;
								  } else if (e.altKey) {
									// Mainam mÄ“rogu visam kompasam
									globalScale += e.deltaY * -0.0005;
									globalScale = Math.min(Math.max(0.5, globalScale), 5); // IerobeÅ¾ojam mÄ“rogu
								  } else if (e.ctrlKey) {
									// RotÄ“jam skalu
									scaleRotation += e.deltaY * 0.005;
								  }
								  updateCompassTransform();
								}, { passive: false });

							// TastatÅ«ras bultiÅ†as - piemÄ“rs: pa kreisi/pa labi bÄzes rotÄcija, uz augÅ¡u/uz leju skalas rotÄcija
								document.addEventListener('keydown', (e) => {
								  if (e.key === 'ArrowLeft') {
									baseRotation -= 5; // pa kreisi rotÄcija bÄzei
								  } else if (e.key === 'ArrowRight') {
									baseRotation += 5; // pa labi rotÄcija bÄzei
								  } else if (e.key === 'ArrowUp') {
									scaleRotation += 5; // skalas rotÄcija
								  } else if (e.key === 'ArrowDown') {
									scaleRotation -= 5; // pretÄ“jÄ virziena skalas rotÄcija
								  }
								  updateCompassTransform();
								});

							// Kad logs ielÄdÄ“jas, novietojam kompasu sÄkuma pozÄ«cijÄ
								window.addEventListener('load', () => {
								  const windowWidth = window.innerWidth;
								  const windowHeight = window.innerHeight;
								  const compassWidth = compassContainer.offsetWidth;
								  const compassHeight = compassContainer.offsetHeight;

								  // Varat pielÄgot sÄkuma pozÄ«ciju pÄ“c vajadzÄ«bas
								  compassStartLeft = 550;
								  compassStartTop = 60;
								  updateCompassTransform();
								});
							

	
								(function() {
								const toggleFullscreenButton = document.getElementById('toggleFullscreen');
								const fullscreenIcon = document.getElementById('fullscreenIcon');
								const fullscreenPopup = document.getElementById('fullscreenPopup');

								const enterFullscreenIcon = 'https://site-710050.mozfiles.com/files/710050/icon_fullscreen_enter.png';
								const exitFullscreenIcon = 'https://site-710050.mozfiles.com/files/710050/icon_fullscreen_exit.png';

								// IestatÄm sÄkotnÄ“jo ikonu
								fullscreenIcon.src = enterFullscreenIcon;

								toggleFullscreenButton.addEventListener('click', () => {
									const elem = document.documentElement;
									if (!isFullscreenActive()) {
										enterFullscreen(elem);
									} else {
										exitFullscreen();
									}
								});

								function enterFullscreen(elem) {
									if (elem.requestFullscreen) {
										elem.requestFullscreen().catch(err => console.warn('PilnekrÄna kÄ¼Å«da:', err));
									} else if (elem.webkitRequestFullscreen) {
										elem.webkitRequestFullscreen();
									} else if (elem.msRequestFullscreen) {
										elem.msRequestFullscreen();
									} else if (elem.mozRequestFullScreen) {
										elem.mozRequestFullScreen();
									}
								}

								function exitFullscreen() {
									if (document.exitFullscreen) {
										document.exitFullscreen().catch(err => console.warn('IzieÅ¡anas kÄ¼Å«da:', err));
									} else if (document.webkitExitFullscreen) {
										document.webkitExitFullscreen();
									} else if (document.msExitFullscreen) {
										document.msExitFullscreen();
									} else if (document.mozCancelFullScreen) {
										document.mozCancelFullScreen();
									}
								}

								function updateButtonState() {
									if (isFullscreenActive()) {
										fullscreenIcon.src = exitFullscreenIcon;
										toggleFullscreenButton.classList.add('active');
										showPopupMessage('PilnekrÄna reÅ¾Ä«ms ieslÄ“gts', 'popup-success');
									} else {
										fullscreenIcon.src = enterFullscreenIcon;
										toggleFullscreenButton.classList.remove('active');
										showPopupMessage('PilnekrÄna reÅ¾Ä«ms izslÄ“gts', 'popup-error');
									}
								}

								function isFullscreenActive() {
									return document.fullscreenElement || 
										   document.webkitFullscreenElement || 
										   document.mozFullScreenElement || 
										   document.msFullscreenElement;
								}

								function showPopupMessage(message, popupClass) {
									fullscreenPopup.textContent = message;
									fullscreenPopup.className = ''; 
									fullscreenPopup.classList.add(popupClass);
									fullscreenPopup.style.display = 'block';

									setTimeout(() => {
										fullscreenPopup.style.display = 'none';
									}, 4000);
								}

								// KlausÄ«tÄji
								document.addEventListener('fullscreenchange', updateButtonState);
								document.addEventListener('webkitfullscreenchange', updateButtonState);
								document.addEventListener('mozfullscreenchange', updateButtonState);
								document.addEventListener('MSFullscreenChange', updateButtonState);

								window.addEventListener('keydown', (e) => {
									if (e.key === 'Escape') {
										exitFullscreen();
									}
								});

								window.addEventListener('visibilitychange', function () {
									if (!document.hidden) {
										updateButtonState();
									}
								});
							})();




							document.getElementById("toggleMaterials").addEventListener("click", function() {
								let menu = document.getElementById("dropdownMaterials");
								let toggleButton = document.getElementById("toggleMaterials");
								menu.classList.toggle("visible");
								toggleButton.classList.toggle("active");
							});

							document.getElementById("toggleInstruction").addEventListener("click", function() {
								let menu = document.getElementById("dropdownInstruction");
								let toggleButton = document.getElementById("toggleInstruction");
								menu.classList.toggle("visible");
								toggleButton.classList.toggle("active");
							});

							document.addEventListener("click", function(event) {
								let instructionMenu = document.getElementById("dropdownInstruction");
								let materialsMenu = document.getElementById("dropdownMaterials");
								let instructionButton = document.getElementById("toggleInstruction");
								let materialsButton = document.getElementById("toggleMaterials");

								if (!instructionMenu.contains(event.target) && !instructionButton.contains(event.target)) {
									instructionMenu.classList.remove("visible");
									instructionButton.classList.remove("active");
								}

								if (!materialsMenu.contains(event.target) && !materialsButton.contains(event.target)) {
									materialsMenu.classList.remove("visible");
									materialsButton.classList.remove("active");
								}
							});


							//ATVER IFRAME MACIBU MATERIALI
							document.querySelectorAll('.dropdown-menu a').forEach(link => {
								link.addEventListener('click', function(event) {
									event.preventDefault();

									let iframe = document.getElementById('contentFrame');
									let dropdownMenus = document.querySelectorAll('.dropdown-menu');

									// ParÄda iframe un palielina tÄ augstumu lÄ«dz 85vh
									iframe.style.display = 'block';
									iframe.classList.add('active');
									iframe.src = this.getAttribute('href');

									// PaceÄ¼ dropdown pogas uz augÅ¡u
									dropdownMenus.forEach(menu => menu.classList.add('shrink'));
								});
							});



							// Aizver iframe un atgrieÅ¾ sÄkotnÄ“jo pogu un iframe pozÄ«ciju MACIBU MATERIALI
							document.getElementById("toggleMaterials").addEventListener("click", function () {
								let iframe = document.getElementById('contentFrame');
								let dropdownMenus = document.querySelectorAll('.dropdown-menu');

								// PaslÄ“pj iframe un atjauno sÄkotnÄ“jo augstumu
								iframe.classList.remove('active');
								setTimeout(() => {
									iframe.style.display = 'none';
									iframe.src = ""; // NoÅ†em saturu
								}, 300); // Aizkave, lai CSS animÄcija pabeigtos pirms iframe slÄ“pÅ¡anas

								// Atjauno dropdown pogu pozÄ«ciju
								dropdownMenus.forEach(menu => menu.classList.remove('shrink'));
							});



							// Atver iframe priekÅ¡ "LietotÄja ceÄ¼veÅ¾a"
							document.querySelectorAll('#dropdownInstruction a').forEach(link => {
								link.addEventListener('click', function(event) {
									event.preventDefault();

									let iframe = document.getElementById('instructionFrame'); // LietotÄja ceÄ¼veÅ¾a iframe
									let dropdownMenus = document.getElementById('dropdownInstruction');

									// ParÄda iframe un ielÄdÄ“ saiti
									iframe.style.display = 'block';
									iframe.classList.add('active');
									iframe.src = this.getAttribute('href');

									// PaslÄ“pj izvÄ“lni
									dropdownMenus.classList.add('shrink');
								});
							});

							// Aizver iframe un atjauno sÄkotnÄ“jo pogu un iframe pozÄ«ciju priekÅ¡ "LietotÄja ceÄ¼veÅ¾a"
							document.getElementById("toggleInstruction").addEventListener("click", function () {
								let iframe = document.getElementById('instructionFrame'); // LietotÄja ceÄ¼veÅ¾a iframe
								let dropdownMenus = document.getElementById('dropdownInstruction');

								iframe.classList.remove('active');
								setTimeout(() => {
									iframe.style.display = 'none';
									iframe.src = ""; // NotÄ«ra saturu
								}, 300);

								dropdownMenus.classList.remove('shrink');
							});




							document.querySelectorAll('.dropdown-menu a').forEach(link => {
								link.addEventListener('click', function(event) {
									event.preventDefault();
									let iframe = document.getElementById('contentFrame');
									let dropdownMenus = document.querySelectorAll('.dropdown-menu');

									// IelÄdÄ“ saiti iframe un parÄda to
									iframe.style.display = 'block';
									iframe.classList.add('active');
									iframe.src = this.getAttribute('href');

									// PaceÄ¼ dropdown pogas uz augÅ¡u
									dropdownMenus.forEach(menu => menu.classList.add('shrink'));
								});
							});




							// Atver atsauksmes un ziÅ†ojumi
							function toggleIframeAbout(event) {
								if (event) event.preventDefault(); // NovÄ“rÅ¡ noklusÄ“to darbÄ«bu

								let iframeContainer = document.getElementById("iframeContainerAbout");
								let computedStyle = window.getComputedStyle(iframeContainer);

								console.log("Poga nospiesta!");
								console.log("iframeContainer sÄkuma statuss:", {
									display: computedStyle.display,
									bottom: computedStyle.bottom
								});

								if (computedStyle.display === "none" || computedStyle.bottom === "-620px") {
									console.log("Atveram iframe...");
									iframeContainer.style.display = "block";
									setTimeout(() => {
										iframeContainer.style.bottom = "35px"; // SlÄ«d uz augÅ¡u no apakÅ¡as
										console.log("iframeContainer pÄ“c atvÄ“rÅ¡anas:", {
											display: iframeContainer.style.display,
											bottom: iframeContainer.style.bottom
										});
									}, 10);
								} else {
									console.log("Aizveram iframe...");
									iframeContainer.style.bottom = "-620px"; // SlÄ«d atpakaÄ¼ uz leju
									setTimeout(() => {
										iframeContainer.style.display = "none";
										console.log("iframeContainer pÄ“c aizvÄ“rÅ¡anas:", {
											display: iframeContainer.style.display,
											bottom: iframeContainer.style.bottom
										});
									}, 500);
								}
							}





							document.addEventListener("DOMContentLoaded", function () {
								let iframeContainer = document.getElementById("iframeContainerAbout");

								// PÄrliecinÄs, ka iframe sÄkumÄ ir paslÄ“pts
								iframeContainer.style.display = "none";
								iframeContainer.style.bottom = "-220px";
								console.log("iframeContainer iestatÄ«ts uz slÄ“gtu stÄvokli lapas ielÄdÄ“!");
							});





							// QR koda atvÄ“rÅ¡ana/aizvÄ“rÅ¡ana
							function toggleIframeQR(event) {
								if (event) event.preventDefault();

								let iframeContainer = document.getElementById("iframeContainerQR");
								let computedStyle = window.getComputedStyle(iframeContainer);

								if (computedStyle.display === "none" || computedStyle.bottom === "-370px") {
									iframeContainer.style.display = "block";
									setTimeout(() => {
										iframeContainer.style.bottom = "35px";
									}, 10);
								} else {
									iframeContainer.style.bottom = "-370px";
									setTimeout(() => {
										iframeContainer.style.display = "none";
									}, 500);
								}
							}

							// PaslÄ“pj QR kodu sÄkumÄ
							document.addEventListener("DOMContentLoaded", function () {
								let iframeContainer = document.getElementById("iframeContainerQR");
								iframeContainer.style.display = "none";
								iframeContainer.style.bottom = "-370px";
							});




							(function(){
							  var bc = document.getElementById('buttonContainer');
							  if(!bc) return;
							
							  /* 1) Izveido â€œÄauluâ€ un ieliek visas esoÅ¡Äs pogas iekÅ¡Ä,
							        + pievieno etiÄ·eti un kupola SVG */
							  var shell = document.createElement('div');
							  shell.className = 'dock-shell';
							
							  // savÄcam tikai tieÅ¡os bÄ“rnus, kas ir pogas:
							  var btns = [];
							  for (var i = bc.children.length - 1; i >= 0; i--) {
							    var el = bc.children[i];
							    if (el.tagName === 'BUTTON') btns.push(el);
							  }
							  btns.reverse().forEach(function(b){ shell.appendChild(b); });
							
							  // izveido label + cap
							  var dockLabel = document.createElement('div');
							  dockLabel.className = 'dock-label';
							  var dockCap = document.createElement('svg');
							  dockCap.className = 'dock-cap'; dockCap.setAttribute('aria-hidden','true');
							
							  // ieliekam shell un pÄ“c tam label+cap (bÅ«t bÄ“rni â€œshellâ€, lai Ä£eometrija bÅ«tu relatÄ«va)
							  bc.appendChild(shell);
							  shell.appendChild(dockCap);
							  shell.appendChild(dockLabel);


  /* â€” DIMMERA UI â€” */
  var dimWrap = document.createElement('div');
  dimWrap.className = 'dock-dimmer';
  dimWrap.innerHTML =
    '<input id="mapDimmerRange" type="range" min="0" max="80" step="1">' +
    '<span class="value" id="mapDimmerValue"></span>';
  shell.insertBefore(dimWrap, shell.firstChild);
  
// Tooltipam un fokusam (tÄpat kÄ pogÄm)
dimWrap.setAttribute('data-title', 'TumÅ¡inÄt karti');
dimWrap.setAttribute('aria-label', 'TumÅ¡inÄt karti');
dimWrap.setAttribute('tabindex', '0');
dimWrap.id = 'mapDimmer'; // ne obligÄti, bet noderÄ«gi

  // sasaistÄm ar mainÄ«go + localStorage
  var dimRange = dimWrap.querySelector('#mapDimmerRange');
  var dimValue = dimWrap.querySelector('#mapDimmerValue');

  var stored = +(localStorage.getItem('mapDarken') || 0);
  mapDarken = stored / 100;        // izmanto globÄlo mainÄ«go no 2. soÄ¼a
  dimRange.value = stored;
  dimValue.textContent = stored + '%';

  dimRange.addEventListener('input', function(e){
    var v = +e.target.value;       // 0..80
    mapDarken = v / 100;           // 0..0.8
    localStorage.setItem('mapDarken', v);
    dimValue.textContent = v + '%';
    drawImage();                   // pÄrzÄ«mÄ“ kanvu ar jaunu tumÅ¡umu
  });

// â¬‡ï¸ Pievieno Å¡o â€” sÄkotnÄ“ji iestata pareizu pÄrklÄjumu (span)
window.__updateDimmerWidth && window.__updateDimmerWidth();


 
							  /* 2) Pievieno etiÄ·eÅ¡u tekstus (ja nav), saglabÄjot Tavu ID loÄ£iku */
							  var titlesById = {
							    resetMap:        'RestartÄ“t karti',
							    uploadMap:       'AugÅ¡upielÄdÄ“t karti',
							    resetCompass:    'RestartÄ“t kompasu',
							    toggleRotationMode: 'Griezt bÄzi / skalu',
							    lockRotationMode:   'BloÄ·Ä“t rotÄciju',
							    rotateCompass90: 'TÄ«klveida reÅ¾Ä«ms',
							    toggleFullscreen:'PilnekrÄna reÅ¾Ä«ms'
							  };
							 var allTriggers = shell.querySelectorAll('button, .dock-dimmer');
							 allTriggers.forEach ? allTriggers.forEach(setTitle) : [].slice.call(allTriggers).forEach(setTitle);

							  function setTitle(b){
							    var id=b.id||'';
							    if(!b.getAttribute('data-title') && titlesById[id]) b.setAttribute('data-title', titlesById[id]);
							    if(!b.getAttribute('aria-label') && titlesById[id]) b.setAttribute('aria-label', titlesById[id]);
							  }
							
							  /* 3) Kupola Ä£eometrija (horizontÄlam izvietojumam) */
							  function updateCapGeometry(){
							    var cs = getComputedStyle(shell);
							    var labelW = parseFloat(cs.getPropertyValue('--labelW')) || 0;
							    var extra  = parseFloat(cs.getPropertyValue('--capExtraW')) || 0;
							    var w = labelW + 22 + extra;
							    var h = parseFloat(cs.getPropertyValue('--capH')) || 0;
							    var inset = parseFloat(cs.getPropertyValue('--capSkew')) || 0;
							    var r = parseFloat(cs.getPropertyValue('--capR')) || 0;
							    if(!w || !h) return;
							
							    var TLx = inset + r, TRx = w - inset - r;
							    var LEx = inset, LEy = r;
							    var REx = w - inset, REy = r;
							
							    var sideMidY = r + (h - r) * 0.45;
							    var rightCP1x = REx + (w - REx) * 0.18, rightCP1y = sideMidY;
							    var rightCP2x = w, rightCP2y = r + (h - r) * 0.82;
							    var leftCP2x  = 0,  leftCP2y  = r + (h - r) * 0.82;
							    var leftCP1x  = LEx - (LEx - 0) * 0.18, leftCP1y  = sideMidY;
							
							    dockCap.setAttribute('viewBox', '0 0 ' + w + ' ' + h);
							    dockCap.setAttribute('width', w);
							    dockCap.setAttribute('height', h);
							    dockCap.innerHTML =
							      '<defs>' +
							        '<linearGradient id="capFill" x1="0" y1="0" x2="0" y2="1">' +
							          '<stop offset="0%"  stop-color="rgba(40,44,52,.96)"/>' +
							          '<stop offset="100%" stop-color="rgba(30,33,40,.96)"/>' +
							        '</linearGradient>' +
							        '<radialGradient id="capShine" cx="50%" cy="-30%" r="120%">' +
							          '<stop offset="0%" stop-color="rgba(255,255,255,.18)"/>' +
							          '<stop offset="60%" stop-color="rgba(255,255,255,0)"/>' +
							        '</radialGradient>' +
							      '</defs>' +
							      '<path d="' +
							        'M ' + TLx + ',0 H ' + TRx + ' A ' + r + ',' + r + ' 0 0 1 ' + REx + ',' + REy + ' ' +
							        'C ' + rightCP1x + ',' + rightCP1y + ' ' + rightCP2x + ',' + rightCP2y + ' ' + w + ',' + h + ' ' +
							        'L 0,' + h + ' C ' + leftCP2x + ',' + leftCP2y + ' ' + leftCP1x + ',' + leftCP1y + ' ' + LEx + ',' + LEy + ' ' +
							        'A ' + r + ',' + r + ' 0 0 1 ' + TLx + ',0 Z" fill="url(#capFill)" stroke="rgba(210,34,34,.38)" stroke-width="1" />' +
							      '<path d="' +
							        'M ' + TLx + ',0 H ' + TRx + ' A ' + r + ',' + r + ' 0 0 1 ' + REx + ',' + REy + ' ' +
							        'C ' + rightCP1x + ',' + rightCP1y + ' ' + rightCP2x + ',' + rightCP2y + ' ' + w + ',' + h + ' ' +
							        'L 0,' + h + ' C ' + leftCP2x + ',' + leftCP2y + ' ' + leftCP1x + ',' + leftCP1y + ' ' + LEx + ',' + LEy + ' ' +
							        'A ' + r + ',' + r + ' 0 0 1 ' + TLx + ',0 Z" fill="url(#capShine)" />';
							  }
							
							  /* 4) KustÄ«ba â€” gluds X horizontÄli; Y vertikÄli */
							  var raf=null, targetX=null, currentX=null;
							  function setTipX(px){
							    targetX = px;
							    if(currentX == null) currentX = px;
							    if(raf) return;
							    function step(){
							      currentX += (targetX - currentX) * 0.25;
							      shell.style.setProperty('--tipX', currentX + 'px');
							      if(Math.abs(targetX - currentX) > 0.5){ raf = requestAnimationFrame(step); }
							      else { shell.style.setProperty('--tipX', targetX + 'px'); raf=null; }
							    }
							    raf = requestAnimationFrame(step);
							  }
							  function setTipY(py){ shell.style.setProperty('--tipY', py + 'px'); }
							
							  function isVertical(){
							    return bc.classList.contains('left') || bc.classList.contains('right');
							  }
							
							  function showFor(btn){
							    var rShell = shell.getBoundingClientRect();
							    var rBtn   = btn.getBoundingClientRect();
							    var title  = btn.getAttribute('data-title') || btn.getAttribute('aria-label') || '';
							
							    dockLabel.textContent = title || '';
							    // lai izmÄ“rÄ«tu Ä«sto platumu/augstumu pirms Ä£eometrijas:
							    dockLabel.style.opacity = '0.001'; // gandrÄ«z neredzams uz mirkli
							    dockLabel.style.pointerEvents = 'none';
							
							    // pieslÄ“dzam klasei animÄcijas stÄvokli
							    shell.classList.add('show-label');
							
							    // pÄ“c nÄkamÄ frame izmÄ“ram platumu/augstumu un atjauninÄm kupolu (horizontÄliem)
							    requestAnimationFrame(function(){
							      var lw = Math.min(dockLabel.scrollWidth + 2, rShell.width - 40);
							      shell.style.setProperty('--labelW', lw + 'px');
							      shell.style.setProperty('--capH', (dockLabel.offsetHeight + 2) + 'px');
							
							      if(!isVertical()){
							        // horizontÄli: kupols redzams
							        shell.classList.add('show-cap');
							        // centrs X:
							        var cx = rBtn.left + rBtn.width/2 - rShell.left;
							        setTipX(cx);
							        updateCapGeometry();
							      }else{
							        // vertikÄli: slÄ“pjam kupolu, slÄ«dam pa Y
							        shell.classList.remove('show-cap');
							        var cy = rBtn.top + rBtn.height/2 - rShell.top;
							        setTipY(cy);
							      }
							      dockLabel.style.opacity = '1';
							    });
							  }
							  function hideTip(){ shell.classList.remove('show-label','show-cap'); }
							
							  /* 5) Notikumi â€“ tikai uz Ä«stajÄm pogÄm, lai neskartu Tavu esoÅ¡o loÄ£iku */
							  var hideT=null;
							  function arm(btn){
							    btn.addEventListener('mouseenter', function(){
							      if(hideT) clearTimeout(hideT);
							      showFor(btn);
							    });
							    btn.addEventListener('focus', function(){
							      showFor(btn);
							    });
							    btn.addEventListener('mouseleave', function(){
							      if(hideT) clearTimeout(hideT);
							      hideT = setTimeout(hideTip, 180);
							    });
							    // touch â€” Ätri parÄdam un pÄ“c 1.6s paslÄ“pjam
							    btn.addEventListener('touchstart', function(){
							      if(hideT) clearTimeout(hideT);
							      showFor(btn);
							      hideT = setTimeout(hideTip, 1600);
							    }, {passive:true});
							  }
							  [].slice.call(allTriggers).forEach(arm);

							
							  // Uz loga izmÄ“ru maiÅ†as â€“ paslÄ“pjam
							  window.addEventListener('resize', hideTip);
							
							  // SÄkotnÄ“jais stÄvoklis: ja vertical, kupolu neredzam
							  if(isVertical()) shell.classList.remove('show-cap');
							  window.__fitDock && window.__fitDock();
							})();
							
							
							// === Auto-fit dokam (#buttonContainer .dock-shell) â€” ar apakÅ¡Ä“jÄs joslas korekciju ===
							(function(){
							  function fitDock(){
							    var bc = document.getElementById('buttonContainer');
							    if(!bc) return;
							    var shell = bc.querySelector('.dock-shell');
							    if(!shell) return;
							
							    var about = document.getElementById('about');
							    var ah = about ? (about.getBoundingClientRect().height || 0) : 0;
							
							    var isVertical = bc.classList.contains('left') || bc.classList.contains('right');
							    var isBottom   = bc.classList.contains('bottom');
							
							    // 1) Novietojums: bottom reÅ¾Ä«mÄ pÄrbÄ«dam virs #about
							    if (isBottom) {
							      var baseBottom = Math.round(window.innerHeight * 0.05); // ~5vh
							      var minBottom  = Math.ceil(ah + 12);                    // droÅ¡a atstarpe virs about
							      bc.style.bottom = Math.max(baseBottom, minBottom) + 'px';
							    } else {
							      // Ä¼aujam CSS kontrolÄ“t (left/right)
							      bc.style.bottom = '';
							    }
							
							    // 2) MÄ“rogs: nomÄ“ram â€œdabiskoâ€ izmÄ“ru bez skalas
							    var prevTransform = shell.style.transform;
							    shell.style.transform = 'none';
							    var natural = shell.getBoundingClientRect();
							    shell.style.transform = prevTransform;
							
							    // pieejamie izmÄ“ri
							    var maxW = window.innerWidth * 0.96;
							    var maxH = window.innerHeight * 0.90;
							
							    // vertical reÅ¾Ä«mÄ atÅ†emam #about augstumu (lai kolonnu nesaplacina)
							    if (isVertical) {
							      maxH = Math.max(120, maxH - ah);
							    }
							
							    // aprÄ“Ä·inÄm scale
							    var scale = isVertical
							      ? Math.min(1, maxH / natural.height)
							      : Math.min(1, maxW / natural.width);
							
							    // tikai samazinÄm, nepalielinÄm (ar saprÄtÄ«gu minimumu)
							    scale = Math.max(0.35, Math.min(1, scale));
							    shell.style.transform = 'scale(' + scale + ')';
							  }
							
							  // padaram pieejamu citur
							  window.__fitDock = fitDock;
							
							  // palaiÅ¾am un klausÄmies izmÄ“ru izmaiÅ†as
							  var t;
							  function queue(){ clearTimeout(t); t = setTimeout(fitDock, 100); }
							  window.addEventListener('load', fitDock);
							  window.addEventListener('resize', queue);
							  window.addEventListener('orientationchange', queue);
							})();
							
							
							// ğŸ”¹ Tagad __fitDock noteikti ir definÄ“ts â€” pielÄgo mÄ“rlogu uzreiz
							window.__fitDock && window.__fitDock();




(function(){
  function updateDimmerPlacement(){
    const bc   = document.getElementById('buttonContainer');
    const dim  = bc?.querySelector('.dock-dimmer');
    if(!bc || !dim) return;

    // NotÄ«rÄm visus iepriekÅ¡ ieliktos inline parametrus,
    // lai strÄdÄ CSS noteikumi atkarÄ«bÄ no .bottom/.left/.right
    dim.style.gridRow = '';
    dim.style.gridColumn = '';
    dim.style.width = '';
    dim.style.maxWidth = '';
  }

  // publiski
  window.__updateDimmerWidth = updateDimmerPlacement;

  // palaidam sÄkumÄ un uz izmÄ“ru izmaiÅ†Äm
  window.addEventListener('load', updateDimmerPlacement);
  window.addEventListener('resize', updateDimmerPlacement);
})();







							(function () {
							  // â”€â”€ nodroÅ¡inÄm, ka ir konteiners â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
							  const bc = document.getElementById('buttonContainer');
							  if (!bc) return;
							
							  // â”€â”€ SVG ikona (backticki aizsargÄti ar \`) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
							  const GRID_ICON = \`
							<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
							          <rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect>
							          <rect x="3" y="14" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect>
							        </svg>
							  \`;
							
							  /* â€” ROKTURIS â€” */
							  const handle = document.createElement('div');
							  handle.className = 'dock-handle';
							  handle.setAttribute('title', 'ParÄdÄ«t pogas');
							  handle.setAttribute('aria-label', 'ParÄdÄ«t pogas');
							  handle.innerHTML = GRID_ICON; // uzreiz ieliekam SVG
							  bc.appendChild(handle);
							
							  /* â€” PUBLISKÄ€S FUNKCIJAS â€” */
							  function dockButtons() { bc.classList.add('docked'); }
							  function showButtons() { bc.classList.remove('docked'); window.__fitDock && window.__fitDock(); }
							
							  // Piesienam rokturim
							  handle.addEventListener('click', showButtons);
							
							  // Ja maina novietojumu ar selectiem â€” atjaunojam un pÄrrÄ“Ä·inÄm izkÄrtojumu
							  const leftSel  = document.getElementById('positionSelectLeft');
							  const rightSel = document.getElementById('positionSelect');
							  function refreshBySelect() { handle.innerHTML = GRID_ICON; window.__fitDock && window.__fitDock(); }
							  leftSel  && leftSel.addEventListener('change', refreshBySelect);
							  rightSel && rightSel.addEventListener('change', refreshBySelect);
							
							  // IelÄpam updateButtonContainerPosition, lai rokturis sekotu
							  if (window.updateButtonContainerPosition) {
							    const _old = window.updateButtonContainerPosition;
							    window.updateButtonContainerPosition = function (pos) {
							      _old(pos);
							      refreshBySelect();
							      // ja bija dokÄ“ts, saglabÄjas; rokturis vienmÄ“r pareizÄ vietÄ
							    };
							  }
							
							  /* â€” AUTOMÄ€TISKÄ€ DOKÄ’Å ANA, kad sÄc â€œdarbu ar saturuâ€ â€” */
							  const map     = document.getElementById('mapCanvas');
							  const compass = document.getElementById('compassContainer');
							
							  ['pointerdown', 'mousedown', 'touchstart'].forEach(ev => {
							    map     && map.addEventListener(ev, dockButtons,    { passive: true });
							    compass && compass.addEventListener(ev, dockButtons, { passive: true });
							  });
							
							  // PÄ“c loga/virtuÄlÄ viewport izmaiÅ†Äm pielÄgo mÄ“rogu
							  function onViewportChange() { window.__fitDock && window.__fitDock(); }
							  window.addEventListener('resize', onViewportChange);
							  if (window.visualViewport) {
							    window.visualViewport.addEventListener('resize', onViewportChange);
							    window.visualViewport.addEventListener('scroll', onViewportChange);
							  }
							})();


                `;
                interactiveWindow.document.body.appendChild(script);
            } else {
                alert('PÄrlÅ«ks bloÄ·Ä“ jaunus logus. LÅ«dzu, atÄ¼aujiet pÄrlÅ«kam atvÄ“rt logus.');
            }
        });
    </script>
